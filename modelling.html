<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>






















    
    
    
    
<div style="display: none;"></div>
  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h1><b> 0. Imports </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-0.-Imports-">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">haversine</span> <span class="k">import</span> <span class="n">haversine</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>

<span class="c1"># Visualization</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="c1"># Statistical Tests</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">f_oneway</span>

<span class="c1"># Preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># Model Selection</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">,</span> <span class="n">RocCurveDisplay</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">RFECV</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>

<span class="c1"># Models</span>
<span class="kn">import</span> <span class="nn">optuna</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="k">import</span> <span class="n">XGBRegressor</span><span class="p">,</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">catboost</span> <span class="k">import</span> <span class="n">CatBoostRegressor</span><span class="p">,</span> <span class="n">CatBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingRegressor</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="k">import</span> <span class="n">LGBMClassifier</span><span class="p">,</span> <span class="n">LGBMRegressor</span>
<span class="kn">import</span> <span class="nn">haversine</span> <span class="k">as</span> <span class="nn">hs</span> 

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">RepeatedStratifiedKFold</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">TimeSeriesSplit</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">GroupKFold</span><span class="p">,</span> <span class="n">LeaveOneGroupOut</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="k">import</span> <span class="n">KNNImputer</span><span class="p">,</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">ExtraTreesRegressor</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">HistGradientBoostingRegressor</span><span class="p">,</span> <span class="n">VotingRegressor</span><span class="p">,</span> <span class="n">StackingRegressor</span><span class="p">,</span> <span class="n">AdaBoostRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">HuberRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_decomposition</span> <span class="k">import</span> <span class="n">PLSRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="k">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">euclidean_distances</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="k">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">,</span> <span class="n">ClassifierMixin</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">FunctionTransformer</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">PowerTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="k">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.calibration</span> <span class="k">import</span> <span class="n">CalibratedClassifierCV</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="k">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="k">import</span> <span class="n">squareform</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="k">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="k">import</span> <span class="n">LGBMRegressor</span>
<span class="kn">from</span> <span class="nn">catboost</span> <span class="k">import</span> <span class="n">CatBoostRegressor</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version &gt;=1.16.5 and &lt;1.23.0 is required for this version of SciPy (detected version 1.23.5
  warnings.warn(f&quot;A NumPy version &gt;={np_minversion} and &lt;{np_maxversion}&quot;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Adjusting plot style</span>

<span class="n">rc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;axes.facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;#F8F8F8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;figure.facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;#F8F8F8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;axes.edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grid.color&quot;</span><span class="p">:</span> <span class="s2">&quot;#EBEBE7&quot;</span> <span class="o">+</span> <span class="s2">&quot;30&quot;</span><span class="p">,</span>
    <span class="s2">&quot;font.family&quot;</span><span class="p">:</span> <span class="s2">&quot;serif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;axes.labelcolor&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;xtick.color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ytick.color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grid.alpha&quot;</span><span class="p">:</span> <span class="mf">0.4</span>
<span class="p">}</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="n">rc</span><span class="p">)</span>
<span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#302c36&#39;</span><span class="p">,</span> <span class="s1">&#39;#037d97&#39;</span><span class="p">,</span> <span class="s1">&#39;#E4591E&#39;</span><span class="p">,</span> <span class="s1">&#39;#C09741&#39;</span><span class="p">,</span>
           <span class="s1">&#39;#EC5B6D&#39;</span><span class="p">,</span> <span class="s1">&#39;#90A6B1&#39;</span><span class="p">,</span> <span class="s1">&#39;#6ca957&#39;</span><span class="p">,</span> <span class="s1">&#39;#D8E3E2&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">colorama</span> <span class="k">import</span> <span class="n">Style</span><span class="p">,</span> <span class="n">Fore</span>
<span class="n">blk</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">BRIGHT</span> <span class="o">+</span> <span class="n">Fore</span><span class="o">.</span><span class="n">BLACK</span>
<span class="n">mgt</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">BRIGHT</span> <span class="o">+</span> <span class="n">Fore</span><span class="o">.</span><span class="n">MAGENTA</span>
<span class="n">red</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">BRIGHT</span> <span class="o">+</span> <span class="n">Fore</span><span class="o">.</span><span class="n">RED</span>
<span class="n">blu</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">BRIGHT</span> <span class="o">+</span> <span class="n">Fore</span><span class="o">.</span><span class="n">BLUE</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">Style</span><span class="o">.</span><span class="n">RESET_ALL</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h1><b> 1. Load data </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-1.-Load-data-">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/playground-series-s3e20/sample_submission.csv&#39;</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/playground-series-s3e20/train.csv&#39;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/playground-series-s3e20/test.csv&#39;</span><span class="p">)</span>

<span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID_LAT_LON_YEAR_WEEK&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ID_LAT_LON_YEAR_WEEK&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latitude</th>
      <th>longitude</th>
      <th>year</th>
      <th>week_no</th>
      <th>SulphurDioxide_SO2_column_number_density</th>
      <th>SulphurDioxide_SO2_column_number_density_amf</th>
      <th>SulphurDioxide_SO2_slant_column_number_density</th>
      <th>SulphurDioxide_cloud_fraction</th>
      <th>SulphurDioxide_sensor_azimuth_angle</th>
      <th>SulphurDioxide_sensor_zenith_angle</th>
      <th>SulphurDioxide_solar_azimuth_angle</th>
      <th>SulphurDioxide_solar_zenith_angle</th>
      <th>SulphurDioxide_SO2_column_number_density_15km</th>
      <th>CarbonMonoxide_CO_column_number_density</th>
      <th>CarbonMonoxide_H2O_column_number_density</th>
      <th>CarbonMonoxide_cloud_height</th>
      <th>CarbonMonoxide_sensor_altitude</th>
      <th>CarbonMonoxide_sensor_azimuth_angle</th>
      <th>CarbonMonoxide_sensor_zenith_angle</th>
      <th>CarbonMonoxide_solar_azimuth_angle</th>
      <th>CarbonMonoxide_solar_zenith_angle</th>
      <th>NitrogenDioxide_NO2_column_number_density</th>
      <th>NitrogenDioxide_tropospheric_NO2_column_number_density</th>
      <th>NitrogenDioxide_stratospheric_NO2_column_number_density</th>
      <th>NitrogenDioxide_NO2_slant_column_number_density</th>
      <th>NitrogenDioxide_tropopause_pressure</th>
      <th>NitrogenDioxide_absorbing_aerosol_index</th>
      <th>NitrogenDioxide_cloud_fraction</th>
      <th>NitrogenDioxide_sensor_altitude</th>
      <th>NitrogenDioxide_sensor_azimuth_angle</th>
      <th>NitrogenDioxide_sensor_zenith_angle</th>
      <th>NitrogenDioxide_solar_azimuth_angle</th>
      <th>NitrogenDioxide_solar_zenith_angle</th>
      <th>Formaldehyde_tropospheric_HCHO_column_number_density</th>
      <th>Formaldehyde_tropospheric_HCHO_column_number_density_amf</th>
      <th>Formaldehyde_HCHO_slant_column_number_density</th>
      <th>Formaldehyde_cloud_fraction</th>
      <th>Formaldehyde_solar_zenith_angle</th>
      <th>Formaldehyde_solar_azimuth_angle</th>
      <th>Formaldehyde_sensor_zenith_angle</th>
      <th>Formaldehyde_sensor_azimuth_angle</th>
      <th>UvAerosolIndex_absorbing_aerosol_index</th>
      <th>UvAerosolIndex_sensor_altitude</th>
      <th>UvAerosolIndex_sensor_azimuth_angle</th>
      <th>UvAerosolIndex_sensor_zenith_angle</th>
      <th>UvAerosolIndex_solar_azimuth_angle</th>
      <th>UvAerosolIndex_solar_zenith_angle</th>
      <th>Ozone_O3_column_number_density</th>
      <th>Ozone_O3_column_number_density_amf</th>
      <th>Ozone_O3_slant_column_number_density</th>
      <th>Ozone_O3_effective_temperature</th>
      <th>Ozone_cloud_fraction</th>
      <th>Ozone_sensor_azimuth_angle</th>
      <th>Ozone_sensor_zenith_angle</th>
      <th>Ozone_solar_azimuth_angle</th>
      <th>Ozone_solar_zenith_angle</th>
      <th>UvAerosolLayerHeight_aerosol_height</th>
      <th>UvAerosolLayerHeight_aerosol_pressure</th>
      <th>UvAerosolLayerHeight_aerosol_optical_depth</th>
      <th>UvAerosolLayerHeight_sensor_zenith_angle</th>
      <th>UvAerosolLayerHeight_sensor_azimuth_angle</th>
      <th>UvAerosolLayerHeight_solar_azimuth_angle</th>
      <th>UvAerosolLayerHeight_solar_zenith_angle</th>
      <th>Cloud_cloud_fraction</th>
      <th>Cloud_cloud_top_pressure</th>
      <th>Cloud_cloud_top_height</th>
      <th>Cloud_cloud_base_pressure</th>
      <th>Cloud_cloud_base_height</th>
      <th>Cloud_cloud_optical_depth</th>
      <th>Cloud_surface_albedo</th>
      <th>Cloud_sensor_azimuth_angle</th>
      <th>Cloud_sensor_zenith_angle</th>
      <th>Cloud_solar_azimuth_angle</th>
      <th>Cloud_solar_zenith_angle</th>
      <th>emission</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.51</td>
      <td>29.29</td>
      <td>2019</td>
      <td>0</td>
      <td>-0.000108</td>
      <td>0.603019</td>
      <td>-0.000065</td>
      <td>0.255668</td>
      <td>-98.593887</td>
      <td>50.843559</td>
      <td>-130.050797</td>
      <td>35.874496</td>
      <td>-0.000027</td>
      <td>0.035370</td>
      <td>1589.024536</td>
      <td>4061.098145</td>
      <td>829530.500000</td>
      <td>71.111977</td>
      <td>52.775928</td>
      <td>-149.875565</td>
      <td>25.965214</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000117</td>
      <td>0.863230</td>
      <td>0.000038</td>
      <td>0.255668</td>
      <td>35.874496</td>
      <td>-130.050797</td>
      <td>50.843559</td>
      <td>-98.593887</td>
      <td>-1.280761</td>
      <td>829864.546875</td>
      <td>-12.628979</td>
      <td>35.632416</td>
      <td>-138.786446</td>
      <td>30.752128</td>
      <td>0.115927</td>
      <td>2.506609</td>
      <td>0.295663</td>
      <td>225.731144</td>
      <td>0.595473</td>
      <td>-12.628979</td>
      <td>35.632416</td>
      <td>-138.786446</td>
      <td>30.752128</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.595473</td>
      <td>53534.732422</td>
      <td>3664.436218</td>
      <td>61085.809570</td>
      <td>2615.120483</td>
      <td>15.568533</td>
      <td>0.272292</td>
      <td>-12.628986</td>
      <td>35.632416</td>
      <td>-138.786423</td>
      <td>30.752140</td>
      <td>3.750994</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.51</td>
      <td>29.29</td>
      <td>2019</td>
      <td>1</td>
      <td>0.000021</td>
      <td>0.728214</td>
      <td>0.000014</td>
      <td>0.130988</td>
      <td>16.592861</td>
      <td>39.137194</td>
      <td>-140.874435</td>
      <td>28.965133</td>
      <td>0.000012</td>
      <td>0.036526</td>
      <td>1772.574405</td>
      <td>1869.040414</td>
      <td>829787.287130</td>
      <td>-1.019594</td>
      <td>38.982368</td>
      <td>-140.158048</td>
      <td>29.562000</td>
      <td>0.000047</td>
      <td>1.639765e-05</td>
      <td>0.00003</td>
      <td>0.000093</td>
      <td>7311.869141</td>
      <td>-1.935386</td>
      <td>0.067038</td>
      <td>829859.960368</td>
      <td>5.471037</td>
      <td>35.265195</td>
      <td>-138.343908</td>
      <td>30.054262</td>
      <td>0.000170</td>
      <td>1.172826</td>
      <td>0.000143</td>
      <td>0.200754</td>
      <td>29.071781</td>
      <td>-141.814827</td>
      <td>43.050213</td>
      <td>4.678839</td>
      <td>-1.548119</td>
      <td>829747.856973</td>
      <td>16.152492</td>
      <td>43.485327</td>
      <td>-142.786141</td>
      <td>28.573627</td>
      <td>0.116775</td>
      <td>2.657704</td>
      <td>0.315733</td>
      <td>226.172170</td>
      <td>0.175166</td>
      <td>24.464335</td>
      <td>42.596541</td>
      <td>-143.097868</td>
      <td>28.213655</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.213608</td>
      <td>63790.296241</td>
      <td>3651.190311</td>
      <td>66969.478735</td>
      <td>3174.572424</td>
      <td>8.690601</td>
      <td>0.256830</td>
      <td>30.359375</td>
      <td>39.557633</td>
      <td>-145.183930</td>
      <td>27.251779</td>
      <td>4.025176</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.51</td>
      <td>29.29</td>
      <td>2019</td>
      <td>2</td>
      <td>0.000514</td>
      <td>0.748199</td>
      <td>0.000385</td>
      <td>0.110018</td>
      <td>72.795837</td>
      <td>52.868816</td>
      <td>-150.191757</td>
      <td>23.206415</td>
      <td>0.000154</td>
      <td>0.035338</td>
      <td>2703.236800</td>
      <td>2809.138386</td>
      <td>829883.828686</td>
      <td>-54.801144</td>
      <td>52.344378</td>
      <td>-133.683714</td>
      <td>31.586838</td>
      <td>0.000031</td>
      <td>4.267369e-07</td>
      <td>0.00003</td>
      <td>0.000080</td>
      <td>7311.869141</td>
      <td>-2.754374</td>
      <td>0.072135</td>
      <td>829527.125000</td>
      <td>72.795837</td>
      <td>52.868816</td>
      <td>-150.191757</td>
      <td>23.206415</td>
      <td>0.000080</td>
      <td>1.175467</td>
      <td>0.000019</td>
      <td>0.279449</td>
      <td>30.994290</td>
      <td>-135.667160</td>
      <td>52.810561</td>
      <td>-41.363579</td>
      <td>-1.038673</td>
      <td>829892.960629</td>
      <td>-41.557633</td>
      <td>41.269033</td>
      <td>-135.364627</td>
      <td>30.273304</td>
      <td>0.117039</td>
      <td>2.619104</td>
      <td>0.310828</td>
      <td>227.469292</td>
      <td>0.606091</td>
      <td>-41.557633</td>
      <td>41.269033</td>
      <td>-135.364627</td>
      <td>30.273304</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.703540</td>
      <td>55923.790554</td>
      <td>4216.986492</td>
      <td>60068.894448</td>
      <td>3516.282669</td>
      <td>21.103410</td>
      <td>0.251101</td>
      <td>15.377883</td>
      <td>30.401823</td>
      <td>-142.519545</td>
      <td>26.193296</td>
      <td>4.231381</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.51</td>
      <td>29.29</td>
      <td>2019</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.036790</td>
      <td>2076.073332</td>
      <td>3917.707873</td>
      <td>829657.163571</td>
      <td>28.916541</td>
      <td>39.676184</td>
      <td>-142.575915</td>
      <td>24.810699</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.626435</td>
      <td>829794.848214</td>
      <td>-0.001270</td>
      <td>34.458740</td>
      <td>-137.489602</td>
      <td>26.936477</td>
      <td>0.116434</td>
      <td>2.525818</td>
      <td>0.297966</td>
      <td>225.589440</td>
      <td>0.787398</td>
      <td>-0.001270</td>
      <td>34.458740</td>
      <td>-137.489602</td>
      <td>26.936477</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.782806</td>
      <td>44569.130636</td>
      <td>5228.507736</td>
      <td>51064.547339</td>
      <td>4180.973322</td>
      <td>15.386899</td>
      <td>0.262043</td>
      <td>-11.293399</td>
      <td>24.380357</td>
      <td>-132.665828</td>
      <td>28.829155</td>
      <td>4.305286</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.51</td>
      <td>29.29</td>
      <td>2019</td>
      <td>4</td>
      <td>-0.000079</td>
      <td>0.676296</td>
      <td>-0.000048</td>
      <td>0.121164</td>
      <td>4.121269</td>
      <td>35.515587</td>
      <td>-137.409159</td>
      <td>24.331972</td>
      <td>-0.000028</td>
      <td>0.034675</td>
      <td>2053.608490</td>
      <td>2667.310013</td>
      <td>829735.093750</td>
      <td>-12.501663</td>
      <td>33.703073</td>
      <td>-134.854258</td>
      <td>24.629593</td>
      <td>0.000051</td>
      <td>2.056437e-05</td>
      <td>0.00003</td>
      <td>0.000093</td>
      <td>7637.262458</td>
      <td>-1.450563</td>
      <td>0.049393</td>
      <td>829744.843750</td>
      <td>-13.431798</td>
      <td>35.078624</td>
      <td>-136.257947</td>
      <td>24.729026</td>
      <td>0.000269</td>
      <td>0.869081</td>
      <td>0.000146</td>
      <td>0.160090</td>
      <td>25.977935</td>
      <td>-134.826557</td>
      <td>39.949069</td>
      <td>-12.837398</td>
      <td>-1.584896</td>
      <td>829736.142857</td>
      <td>-0.604325</td>
      <td>41.794705</td>
      <td>-136.448518</td>
      <td>25.045785</td>
      <td>0.117373</td>
      <td>2.572243</td>
      <td>0.306688</td>
      <td>228.955840</td>
      <td>0.215739</td>
      <td>-0.604325</td>
      <td>41.794705</td>
      <td>-136.448518</td>
      <td>25.045785</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.189336</td>
      <td>59904.314844</td>
      <td>3980.598120</td>
      <td>63751.125781</td>
      <td>3355.710107</td>
      <td>8.114694</td>
      <td>0.235847</td>
      <td>38.532263</td>
      <td>37.392979</td>
      <td>-141.509805</td>
      <td>22.204612</td>
      <td>4.347317</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h1><b> 2. EDA </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-2.-EDA-">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>\
    <span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">G10</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>\
    <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;50%&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;BuGn&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

<table>
  <thead>
    <tr>
      <th class="blank level0">&#160;</th>
      <th class="col_heading level0 col0">count</th>
      <th class="col_heading level0 col1">mean</th>
      <th class="col_heading level0 col2">std</th>
      <th class="col_heading level0 col3">min</th>
      <th class="col_heading level0 col4">25%</th>
      <th class="col_heading level0 col5">50%</th>
      <th class="col_heading level0 col6">75%</th>
      <th class="col_heading level0 col7">max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th class="row_heading level0 row0">latitude</th>
      <td class="data row0 col0">79023.000000</td>
      <td class="data row0 col1">-1.891072</td>
      <td class="data row0 col2">0.694522</td>
      <td class="data row0 col3">-3.299000</td>
      <td class="data row0 col4">-2.451000</td>
      <td class="data row0 col5">-1.882000</td>
      <td class="data row0 col6">-1.303000</td>
      <td class="data row0 col7">-0.510000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row1">longitude</th>
      <td class="data row1 col0">79023.000000</td>
      <td class="data row1 col1">29.880155</td>
      <td class="data row1 col2">0.810375</td>
      <td class="data row1 col3">28.228000</td>
      <td class="data row1 col4">29.262000</td>
      <td class="data row1 col5">29.883000</td>
      <td class="data row1 col6">30.471000</td>
      <td class="data row1 col7">31.532000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row2">year</th>
      <td class="data row2 col0">79023.000000</td>
      <td class="data row2 col1">2020.000000</td>
      <td class="data row2 col2">0.816502</td>
      <td class="data row2 col3">2019.000000</td>
      <td class="data row2 col4">2019.000000</td>
      <td class="data row2 col5">2020.000000</td>
      <td class="data row2 col6">2021.000000</td>
      <td class="data row2 col7">2021.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row3">week_no</th>
      <td class="data row3 col0">79023.000000</td>
      <td class="data row3 col1">26.000000</td>
      <td class="data row3 col2">15.297155</td>
      <td class="data row3 col3">0.000000</td>
      <td class="data row3 col4">13.000000</td>
      <td class="data row3 col5">26.000000</td>
      <td class="data row3 col6">39.000000</td>
      <td class="data row3 col7">52.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row4">SulphurDioxide_SO2_column_number_density</th>
      <td class="data row4 col0">64414.000000</td>
      <td class="data row4 col1">0.000048</td>
      <td class="data row4 col2">0.000272</td>
      <td class="data row4 col3">-0.000996</td>
      <td class="data row4 col4">-0.000096</td>
      <td class="data row4 col5">0.000024</td>
      <td class="data row4 col6">0.000153</td>
      <td class="data row4 col7">0.004191</td>
    </tr>
    <tr>
      <th class="row_heading level0 row5">SulphurDioxide_SO2_column_number_density_amf</th>
      <td class="data row5 col0">64414.000000</td>
      <td class="data row5 col1">0.834848</td>
      <td class="data row5 col2">0.185382</td>
      <td class="data row5 col3">0.241822</td>
      <td class="data row5 col4">0.705817</td>
      <td class="data row5 col5">0.809118</td>
      <td class="data row5 col6">0.942792</td>
      <td class="data row5 col7">1.885239</td>
    </tr>
    <tr>
      <th class="row_heading level0 row6">SulphurDioxide_SO2_slant_column_number_density</th>
      <td class="data row6 col0">64414.000000</td>
      <td class="data row6 col1">0.000035</td>
      <td class="data row6 col2">0.000206</td>
      <td class="data row6 col3">-0.000887</td>
      <td class="data row6 col4">-0.000078</td>
      <td class="data row6 col5">0.000019</td>
      <td class="data row6 col6">0.000121</td>
      <td class="data row6 col7">0.004236</td>
    </tr>
    <tr>
      <th class="row_heading level0 row7">SulphurDioxide_cloud_fraction</th>
      <td class="data row7 col0">64414.000000</td>
      <td class="data row7 col1">0.158418</td>
      <td class="data row7 col2">0.071364</td>
      <td class="data row7 col3">0.000000</td>
      <td class="data row7 col4">0.110535</td>
      <td class="data row7 col5">0.161855</td>
      <td class="data row7 col6">0.211824</td>
      <td class="data row7 col7">0.299998</td>
    </tr>
    <tr>
      <th class="row_heading level0 row8">SulphurDioxide_sensor_azimuth_angle</th>
      <td class="data row8 col0">64414.000000</td>
      <td class="data row8 col1">-7.925870</td>
      <td class="data row8 col2">64.263368</td>
      <td class="data row8 col3">-179.537059</td>
      <td class="data row8 col4">-56.782383</td>
      <td class="data row8 col5">-12.441726</td>
      <td class="data row8 col6">72.059990</td>
      <td class="data row8 col7">122.095200</td>
    </tr>
    <tr>
      <th class="row_heading level0 row9">SulphurDioxide_sensor_zenith_angle</th>
      <td class="data row9 col0">64414.000000</td>
      <td class="data row9 col1">37.436189</td>
      <td class="data row9 col2">14.149950</td>
      <td class="data row9 col3">0.099237</td>
      <td class="data row9 col4">28.844520</td>
      <td class="data row9 col5">37.784299</td>
      <td class="data row9 col6">47.634875</td>
      <td class="data row9 col7">66.242012</td>
    </tr>
    <tr>
      <th class="row_heading level0 row10">SulphurDioxide_solar_azimuth_angle</th>
      <td class="data row10 col0">64414.000000</td>
      <td class="data row10 col1">-83.833174</td>
      <td class="data row10 col2">38.103737</td>
      <td class="data row10 col3">-157.289337</td>
      <td class="data row10 col4">-122.247621</td>
      <td class="data row10 col5">-79.788767</td>
      <td class="data row10 col6">-46.919229</td>
      <td class="data row10 col7">-19.836636</td>
    </tr>
    <tr>
      <th class="row_heading level0 row11">SulphurDioxide_solar_zenith_angle</th>
      <td class="data row11 col0">64414.000000</td>
      <td class="data row11 col1">27.722311</td>
      <td class="data row11 col2">5.506244</td>
      <td class="data row11 col3">8.227846</td>
      <td class="data row11 col4">23.928350</td>
      <td class="data row11 col5">28.178639</td>
      <td class="data row11 col6">31.848859</td>
      <td class="data row11 col7">42.887123</td>
    </tr>
    <tr>
      <th class="row_heading level0 row12">SulphurDioxide_SO2_column_number_density_15km</th>
      <td class="data row12 col0">64414.000000</td>
      <td class="data row12 col1">0.000015</td>
      <td class="data row12 col2">0.000089</td>
      <td class="data row12 col3">-0.001319</td>
      <td class="data row12 col4">-0.000033</td>
      <td class="data row12 col5">0.000007</td>
      <td class="data row12 col6">0.000051</td>
      <td class="data row12 col7">0.001956</td>
    </tr>
    <tr>
      <th class="row_heading level0 row13">CarbonMonoxide_CO_column_number_density</th>
      <td class="data row13 col0">76901.000000</td>
      <td class="data row13 col1">0.033158</td>
      <td class="data row13 col2">0.006023</td>
      <td class="data row13 col3">0.015793</td>
      <td class="data row13 col4">0.029064</td>
      <td class="data row13 col5">0.032253</td>
      <td class="data row13 col6">0.036022</td>
      <td class="data row13 col7">0.072990</td>
    </tr>
    <tr>
      <th class="row_heading level0 row14">CarbonMonoxide_H2O_column_number_density</th>
      <td class="data row14 col0">76901.000000</td>
      <td class="data row14 col1">2113.906233</td>
      <td class="data row14 col2">619.561233</td>
      <td class="data row14 col3">276.370929</td>
      <td class="data row14 col4">1698.455138</td>
      <td class="data row14 col5">2035.418030</td>
      <td class="data row14 col6">2421.942057</td>
      <td class="data row14 col7">9193.168945</td>
    </tr>
    <tr>
      <th class="row_heading level0 row15">CarbonMonoxide_cloud_height</th>
      <td class="data row15 col0">76901.000000</td>
      <td class="data row15 col1">2821.590722</td>
      <td class="data row15 col2">792.480084</td>
      <td class="data row15 col3">-368.845684</td>
      <td class="data row15 col4">2302.090982</td>
      <td class="data row15 col5">2852.535556</td>
      <td class="data row15 col6">3367.086262</td>
      <td class="data row15 col7">4999.379883</td>
    </tr>
    <tr>
      <th class="row_heading level0 row16">CarbonMonoxide_sensor_altitude</th>
      <td class="data row16 col0">76901.000000</td>
      <td class="data row16 col1">829938.633762</td>
      <td class="data row16 col2">172.521518</td>
      <td class="data row16 col3">829253.687500</td>
      <td class="data row16 col4">829819.133559</td>
      <td class="data row16 col5">829941.610652</td>
      <td class="data row16 col6">830059.812500</td>
      <td class="data row16 col7">830487.875000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row17">CarbonMonoxide_sensor_azimuth_angle</th>
      <td class="data row17 col0">76901.000000</td>
      <td class="data row17 col1">-7.331051</td>
      <td class="data row17 col2">46.890763</td>
      <td class="data row17 col3">-98.300018</td>
      <td class="data row17 col4">-40.616552</td>
      <td class="data row17 col5">-12.337376</td>
      <td class="data row17 col6">22.505909</td>
      <td class="data row17 col7">76.580513</td>
    </tr>
    <tr>
      <th class="row_heading level0 row18">CarbonMonoxide_sensor_zenith_angle</th>
      <td class="data row18 col0">76901.000000</td>
      <td class="data row18 col1">37.846794</td>
      <td class="data row18 col2">10.584376</td>
      <td class="data row18 col3">1.107561</td>
      <td class="data row18 col4">31.501828</td>
      <td class="data row18 col5">38.220766</td>
      <td class="data row18 col6">44.457196</td>
      <td class="data row18 col7">65.389618</td>
    </tr>
    <tr>
      <th class="row_heading level0 row19">CarbonMonoxide_solar_azimuth_angle</th>
      <td class="data row19 col0">76901.000000</td>
      <td class="data row19 col1">-86.049580</td>
      <td class="data row19 col2">37.893299</td>
      <td class="data row19 col3">-156.620575</td>
      <td class="data row19 col4">-124.643829</td>
      <td class="data row19 col5">-83.376035</td>
      <td class="data row19 col6">-47.787417</td>
      <td class="data row19 col7">-21.999680</td>
    </tr>
    <tr>
      <th class="row_heading level0 row20">CarbonMonoxide_solar_zenith_angle</th>
      <td class="data row20 col0">76901.000000</td>
      <td class="data row20 col1">27.767024</td>
      <td class="data row20 col2">4.912692</td>
      <td class="data row20 col3">9.028073</td>
      <td class="data row20 col4">24.225765</td>
      <td class="data row20 col5">28.171029</td>
      <td class="data row20 col6">31.647395</td>
      <td class="data row20 col7">42.779541</td>
    </tr>
    <tr>
      <th class="row_heading level0 row21">NitrogenDioxide_NO2_column_number_density</th>
      <td class="data row21 col0">60703.000000</td>
      <td class="data row21 col1">0.000044</td>
      <td class="data row21 col2">0.000010</td>
      <td class="data row21 col3">-0.000013</td>
      <td class="data row21 col4">0.000038</td>
      <td class="data row21 col5">0.000044</td>
      <td class="data row21 col6">0.000050</td>
      <td class="data row21 col7">0.000217</td>
    </tr>
    <tr>
      <th class="row_heading level0 row22">NitrogenDioxide_tropospheric_NO2_column_number_density</th>
      <td class="data row22 col0">60703.000000</td>
      <td class="data row22 col1">0.000012</td>
      <td class="data row22 col2">0.000008</td>
      <td class="data row22 col3">-0.000028</td>
      <td class="data row22 col4">0.000007</td>
      <td class="data row22 col5">0.000012</td>
      <td class="data row22 col6">0.000017</td>
      <td class="data row22 col7">0.000173</td>
    </tr>
    <tr>
      <th class="row_heading level0 row23">NitrogenDioxide_stratospheric_NO2_column_number_density</th>
      <td class="data row23 col0">60703.000000</td>
      <td class="data row23 col1">0.000032</td>
      <td class="data row23 col2">0.000004</td>
      <td class="data row23 col3">0.000022</td>
      <td class="data row23 col4">0.000029</td>
      <td class="data row23 col5">0.000031</td>
      <td class="data row23 col6">0.000035</td>
      <td class="data row23 col7">0.000045</td>
    </tr>
    <tr>
      <th class="row_heading level0 row24">NitrogenDioxide_NO2_slant_column_number_density</th>
      <td class="data row24 col0">60703.000000</td>
      <td class="data row24 col1">0.000097</td>
      <td class="data row24 col2">0.000019</td>
      <td class="data row24 col3">0.000033</td>
      <td class="data row24 col4">0.000084</td>
      <td class="data row24 col5">0.000096</td>
      <td class="data row24 col6">0.000109</td>
      <td class="data row24 col7">0.000226</td>
    </tr>
    <tr>
      <th class="row_heading level0 row25">NitrogenDioxide_tropopause_pressure</th>
      <td class="data row25 col0">60703.000000</td>
      <td class="data row25 col1">8922.568995</td>
      <td class="data row25 col2">892.457113</td>
      <td class="data row25 col3">7311.868446</td>
      <td class="data row25 col4">8613.275800</td>
      <td class="data row25 col5">8613.720662</td>
      <td class="data row25 col6">9579.046670</td>
      <td class="data row25 col7">13031.054757</td>
    </tr>
    <tr>
      <th class="row_heading level0 row26">NitrogenDioxide_absorbing_aerosol_index</th>
      <td class="data row26 col0">60703.000000</td>
      <td class="data row26 col1">-1.812155</td>
      <td class="data row26 col2">0.687334</td>
      <td class="data row26 col3">-4.603670</td>
      <td class="data row26 col4">-2.260316</td>
      <td class="data row26 col5">-1.868650</td>
      <td class="data row26 col6">-1.421014</td>
      <td class="data row26 col7">1.372170</td>
    </tr>
    <tr>
      <th class="row_heading level0 row27">NitrogenDioxide_cloud_fraction</th>
      <td class="data row27 col0">60703.000000</td>
      <td class="data row27 col1">0.097008</td>
      <td class="data row27 col2">0.057601</td>
      <td class="data row27 col3">0.000000</td>
      <td class="data row27 col4">0.059921</td>
      <td class="data row27 col5">0.090985</td>
      <td class="data row27 col6">0.124541</td>
      <td class="data row27 col7">0.765748</td>
    </tr>
    <tr>
      <th class="row_heading level0 row28">NitrogenDioxide_sensor_altitude</th>
      <td class="data row28 col0">60703.000000</td>
      <td class="data row28 col1">829994.224471</td>
      <td class="data row28 col2">220.146974</td>
      <td class="data row28 col3">829248.037829</td>
      <td class="data row28 col4">829847.875000</td>
      <td class="data row28 col5">830007.833333</td>
      <td class="data row28 col6">830150.118750</td>
      <td class="data row28 col7">830581.562500</td>
    </tr>
    <tr>
      <th class="row_heading level0 row29">NitrogenDioxide_sensor_azimuth_angle</th>
      <td class="data row29 col0">60703.000000</td>
      <td class="data row29 col1">-15.937696</td>
      <td class="data row29 col2">68.017010</td>
      <td class="data row29 col3">-179.537059</td>
      <td class="data row29 col4">-98.251366</td>
      <td class="data row29 col5">-13.021288</td>
      <td class="data row29 col6">71.812606</td>
      <td class="data row29 col7">122.095200</td>
    </tr>
    <tr>
      <th class="row_heading level0 row30">NitrogenDioxide_sensor_zenith_angle</th>
      <td class="data row30 col0">60703.000000</td>
      <td class="data row30 col1">36.852637</td>
      <td class="data row30 col2">15.117660</td>
      <td class="data row30 col3">0.099237</td>
      <td class="data row30 col4">26.652634</td>
      <td class="data row30 col5">36.952294</td>
      <td class="data row30 col6">48.017517</td>
      <td class="data row30 col7">66.241872</td>
    </tr>
    <tr>
      <th class="row_heading level0 row31">NitrogenDioxide_solar_azimuth_angle</th>
      <td class="data row31 col0">60703.000000</td>
      <td class="data row31 col1">-84.260082</td>
      <td class="data row31 col2">37.305199</td>
      <td class="data row31 col3">-158.883316</td>
      <td class="data row31 col4">-121.597793</td>
      <td class="data row31 col5">-81.628029</td>
      <td class="data row31 col6">-48.275342</td>
      <td class="data row31 col7">-19.863918</td>
    </tr>
    <tr>
      <th class="row_heading level0 row32">NitrogenDioxide_solar_zenith_angle</th>
      <td class="data row32 col0">60703.000000</td>
      <td class="data row32 col1">28.316388</td>
      <td class="data row32 col2">5.602123</td>
      <td class="data row32 col3">8.227524</td>
      <td class="data row32 col4">24.547083</td>
      <td class="data row32 col5">28.797087</td>
      <td class="data row32 col6">32.286960</td>
      <td class="data row32 col7">42.981857</td>
    </tr>
    <tr>
      <th class="row_heading level0 row33">Formaldehyde_tropospheric_HCHO_column_number_density</th>
      <td class="data row33 col0">71746.000000</td>
      <td class="data row33 col1">0.000127</td>
      <td class="data row33 col2">0.000091</td>
      <td class="data row33 col3">-0.000445</td>
      <td class="data row33 col4">0.000072</td>
      <td class="data row33 col5">0.000123</td>
      <td class="data row33 col6">0.000179</td>
      <td class="data row33 col7">0.001174</td>
    </tr>
    <tr>
      <th class="row_heading level0 row34">Formaldehyde_tropospheric_HCHO_column_number_density_amf</th>
      <td class="data row34 col0">71746.000000</td>
      <td class="data row34 col1">1.254134</td>
      <td class="data row34 col2">0.274884</td>
      <td class="data row34 col3">0.376463</td>
      <td class="data row34 col4">1.058027</td>
      <td class="data row34 col5">1.212767</td>
      <td class="data row34 col6">1.415125</td>
      <td class="data row34 col7">2.760419</td>
    </tr>
    <tr>
      <th class="row_heading level0 row35">Formaldehyde_HCHO_slant_column_number_density</th>
      <td class="data row35 col0">71746.000000</td>
      <td class="data row35 col1">0.000084</td>
      <td class="data row35 col2">0.000097</td>
      <td class="data row35 col3">-0.000647</td>
      <td class="data row35 col4">0.000027</td>
      <td class="data row35 col5">0.000085</td>
      <td class="data row35 col6">0.000142</td>
      <td class="data row35 col7">0.000856</td>
    </tr>
    <tr>
      <th class="row_heading level0 row36">Formaldehyde_cloud_fraction</th>
      <td class="data row36 col0">71746.000000</td>
      <td class="data row36 col1">0.228801</td>
      <td class="data row36 col2">0.099622</td>
      <td class="data row36 col3">0.000000</td>
      <td class="data row36 col4">0.159925</td>
      <td class="data row36 col5">0.227673</td>
      <td class="data row36 col6">0.296572</td>
      <td class="data row36 col7">0.558128</td>
    </tr>
    <tr>
      <th class="row_heading level0 row37">Formaldehyde_solar_zenith_angle</th>
      <td class="data row37 col0">71746.000000</td>
      <td class="data row37 col1">27.887813</td>
      <td class="data row37 col2">5.490569</td>
      <td class="data row37 col3">8.459617</td>
      <td class="data row37 col4">24.108644</td>
      <td class="data row37 col5">28.324679</td>
      <td class="data row37 col6">32.032670</td>
      <td class="data row37 col7">42.733612</td>
    </tr>
    <tr>
      <th class="row_heading level0 row38">Formaldehyde_solar_azimuth_angle</th>
      <td class="data row38 col0">71746.000000</td>
      <td class="data row38 col1">-84.605844</td>
      <td class="data row38 col2">38.046843</td>
      <td class="data row38 col3">-157.362152</td>
      <td class="data row38 col4">-123.057864</td>
      <td class="data row38 col5">-81.292011</td>
      <td class="data row38 col6">-47.310371</td>
      <td class="data row38 col7">-19.718948</td>
    </tr>
    <tr>
      <th class="row_heading level0 row39">Formaldehyde_sensor_zenith_angle</th>
      <td class="data row39 col0">71746.000000</td>
      <td class="data row39 col1">40.478057</td>
      <td class="data row39 col2">12.737188</td>
      <td class="data row39 col3">0.099237</td>
      <td class="data row39 col4">32.976928</td>
      <td class="data row39 col5">40.733671</td>
      <td class="data row39 col6">49.563441</td>
      <td class="data row39 col7">66.241966</td>
    </tr>
    <tr>
      <th class="row_heading level0 row40">Formaldehyde_sensor_azimuth_angle</th>
      <td class="data row40 col0">71746.000000</td>
      <td class="data row40 col1">-9.396089</td>
      <td class="data row40 col2">58.158933</td>
      <td class="data row40 col3">-135.562535</td>
      <td class="data row40 col4">-43.059092</td>
      <td class="data row40 col5">-12.553946</td>
      <td class="data row40 col6">31.021569</td>
      <td class="data row40 col7">106.133474</td>
    </tr>
    <tr>
      <th class="row_heading level0 row41">UvAerosolIndex_absorbing_aerosol_index</th>
      <td class="data row41 col0">78484.000000</td>
      <td class="data row41 col1">-1.342787</td>
      <td class="data row41 col2">0.443335</td>
      <td class="data row41 col3">-3.248241</td>
      <td class="data row41 col4">-1.641220</td>
      <td class="data row41 col5">-1.346869</td>
      <td class="data row41 col6">-1.045034</td>
      <td class="data row41 col7">1.080224</td>
    </tr>
    <tr>
      <th class="row_heading level0 row42">UvAerosolIndex_sensor_altitude</th>
      <td class="data row42 col0">78484.000000</td>
      <td class="data row42 col1">829974.542096</td>
      <td class="data row42 col2">137.183197</td>
      <td class="data row42 col3">829350.383516</td>
      <td class="data row42 col4">829871.622847</td>
      <td class="data row42 col5">829967.417653</td>
      <td class="data row42 col6">830072.993123</td>
      <td class="data row42 col7">830498.368631</td>
    </tr>
    <tr>
      <th class="row_heading level0 row43">UvAerosolIndex_sensor_azimuth_angle</th>
      <td class="data row43 col0">78484.000000</td>
      <td class="data row43 col1">-12.739997</td>
      <td class="data row43 col2">26.303312</td>
      <td class="data row43 col3">-99.808195</td>
      <td class="data row43 col4">-25.637370</td>
      <td class="data row43 col5">-12.756228</td>
      <td class="data row43 col6">0.063665</td>
      <td class="data row43 col7">74.349663</td>
    </tr>
    <tr>
      <th class="row_heading level0 row44">UvAerosolIndex_sensor_zenith_angle</th>
      <td class="data row44 col0">78484.000000</td>
      <td class="data row44 col1">39.962875</td>
      <td class="data row44 col2">5.694265</td>
      <td class="data row44 col3">3.969079</td>
      <td class="data row44 col4">35.527236</td>
      <td class="data row44 col5">41.163119</td>
      <td class="data row44 col6">43.816032</td>
      <td class="data row44 col7">66.450478</td>
    </tr>
    <tr>
      <th class="row_heading level0 row45">UvAerosolIndex_solar_azimuth_angle</th>
      <td class="data row45 col0">78484.000000</td>
      <td class="data row45 col1">-86.548895</td>
      <td class="data row45 col2">37.491634</td>
      <td class="data row45 col3">-158.132324</td>
      <td class="data row45 col4">-125.523336</td>
      <td class="data row45 col5">-84.567350</td>
      <td class="data row45 col6">-48.023048</td>
      <td class="data row45 col7">-26.558869</td>
    </tr>
    <tr>
      <th class="row_heading level0 row46">UvAerosolIndex_solar_zenith_angle</th>
      <td class="data row46 col0">78484.000000</td>
      <td class="data row46 col1">28.052553</td>
      <td class="data row46 col2">4.326584</td>
      <td class="data row46 col3">15.071316</td>
      <td class="data row46 col4">24.805399</td>
      <td class="data row46 col5">28.512156</td>
      <td class="data row46 col6">31.580547</td>
      <td class="data row46 col7">39.473399</td>
    </tr>
    <tr>
      <th class="row_heading level0 row47">Ozone_O3_column_number_density</th>
      <td class="data row47 col0">78475.000000</td>
      <td class="data row47 col1">0.117343</td>
      <td class="data row47 col2">0.003217</td>
      <td class="data row47 col3">0.106192</td>
      <td class="data row47 col4">0.115793</td>
      <td class="data row47 col5">0.117783</td>
      <td class="data row47 col6">0.119553</td>
      <td class="data row47 col7">0.126080</td>
    </tr>
    <tr>
      <th class="row_heading level0 row48">Ozone_O3_column_number_density_amf</th>
      <td class="data row48 col0">78475.000000</td>
      <td class="data row48 col1">2.609890</td>
      <td class="data row48 col2">0.137674</td>
      <td class="data row48 col3">2.111820</td>
      <td class="data row48 col4">2.520587</td>
      <td class="data row48 col5">2.602300</td>
      <td class="data row48 col6">2.691638</td>
      <td class="data row48 col7">3.640139</td>
    </tr>
    <tr>
      <th class="row_heading level0 row49">Ozone_O3_slant_column_number_density</th>
      <td class="data row49 col0">78475.000000</td>
      <td class="data row49 col1">0.310802</td>
      <td class="data row49 col2">0.017414</td>
      <td class="data row49 col3">0.246040</td>
      <td class="data row49 col4">0.298812</td>
      <td class="data row49 col5">0.310059</td>
      <td class="data row49 col6">0.321587</td>
      <td class="data row49 col7">0.418492</td>
    </tr>
    <tr>
      <th class="row_heading level0 row50">Ozone_O3_effective_temperature</th>
      <td class="data row50 col0">78475.000000</td>
      <td class="data row50 col1">228.625917</td>
      <td class="data row50 col2">2.411096</td>
      <td class="data row50 col3">208.137089</td>
      <td class="data row50 col4">227.179151</td>
      <td class="data row50 col5">228.813123</td>
      <td class="data row50 col6">230.306460</td>
      <td class="data row50 col7">237.868655</td>
    </tr>
    <tr>
      <th class="row_heading level0 row51">Ozone_cloud_fraction</th>
      <td class="data row51 col0">78475.000000</td>
      <td class="data row51 col1">0.569107</td>
      <td class="data row51 col2">0.196082</td>
      <td class="data row51 col3">0.002124</td>
      <td class="data row51 col4">0.434704</td>
      <td class="data row51 col5">0.580060</td>
      <td class="data row51 col6">0.711585</td>
      <td class="data row51 col7">1.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row52">Ozone_sensor_azimuth_angle</th>
      <td class="data row52 col0">78475.000000</td>
      <td class="data row52 col1">-13.108799</td>
      <td class="data row52 col2">26.295063</td>
      <td class="data row52 col3">-99.685563</td>
      <td class="data row52 col4">-25.668078</td>
      <td class="data row52 col5">-12.760649</td>
      <td class="data row52 col6">0.053940</td>
      <td class="data row52 col7">74.364489</td>
    </tr>
    <tr>
      <th class="row_heading level0 row53">Ozone_sensor_zenith_angle</th>
      <td class="data row53 col0">78475.000000</td>
      <td class="data row53 col1">39.807404</td>
      <td class="data row53 col2">5.689562</td>
      <td class="data row53 col3">3.372145</td>
      <td class="data row53 col4">35.467393</td>
      <td class="data row53 col5">41.152296</td>
      <td class="data row53 col6">43.377747</td>
      <td class="data row53 col7">66.235573</td>
    </tr>
    <tr>
      <th class="row_heading level0 row54">Ozone_solar_azimuth_angle</th>
      <td class="data row54 col0">78475.000000</td>
      <td class="data row54 col1">-86.529414</td>
      <td class="data row54 col2">37.390642</td>
      <td class="data row54 col3">-157.937073</td>
      <td class="data row54 col4">-125.459912</td>
      <td class="data row54 col5">-84.590871</td>
      <td class="data row54 col6">-48.109230</td>
      <td class="data row54 col7">-26.556996</td>
    </tr>
    <tr>
      <th class="row_heading level0 row55">Ozone_solar_zenith_angle</th>
      <td class="data row55 col0">78475.000000</td>
      <td class="data row55 col1">28.104019</td>
      <td class="data row55 col2">4.310560</td>
      <td class="data row55 col3">15.072850</td>
      <td class="data row55 col4">24.851645</td>
      <td class="data row55 col5">28.538096</td>
      <td class="data row55 col6">31.612094</td>
      <td class="data row55 col7">39.473399</td>
    </tr>
    <tr>
      <th class="row_heading level0 row56">UvAerosolLayerHeight_aerosol_height</th>
      <td class="data row56 col0">439.000000</td>
      <td class="data row56 col1">3582.971238</td>
      <td class="data row56 col2">1475.338534</td>
      <td class="data row56 col3">1164.338745</td>
      <td class="data row56 col4">2525.827163</td>
      <td class="data row56 col5">3273.519127</td>
      <td class="data row56 col6">4287.121499</td>
      <td class="data row56 col7">12948.073199</td>
    </tr>
    <tr>
      <th class="row_heading level0 row57">UvAerosolLayerHeight_aerosol_pressure</th>
      <td class="data row57 col0">439.000000</td>
      <td class="data row57 col1">66718.981285</td>
      <td class="data row57 col2">11501.504673</td>
      <td class="data row57 col3">10920.485315</td>
      <td class="data row57 col4">60366.423652</td>
      <td class="data row57 col5">68663.265784</td>
      <td class="data row57 col6">75325.978912</td>
      <td class="data row57 col7">88296.703125</td>
    </tr>
    <tr>
      <th class="row_heading level0 row58">UvAerosolLayerHeight_aerosol_optical_depth</th>
      <td class="data row58 col0">439.000000</td>
      <td class="data row58 col1">0.732535</td>
      <td class="data row58 col2">0.509865</td>
      <td class="data row58 col3">-0.377114</td>
      <td class="data row58 col4">0.322011</td>
      <td class="data row58 col5">0.616453</td>
      <td class="data row58 col6">1.061440</td>
      <td class="data row58 col7">2.142224</td>
    </tr>
    <tr>
      <th class="row_heading level0 row59">UvAerosolLayerHeight_sensor_zenith_angle</th>
      <td class="data row59 col0">439.000000</td>
      <td class="data row59 col1">30.474482</td>
      <td class="data row59 col2">18.746587</td>
      <td class="data row59 col3">0.238394</td>
      <td class="data row59 col4">13.820117</td>
      <td class="data row59 col5">30.888374</td>
      <td class="data row59 col6">45.727116</td>
      <td class="data row59 col7">66.165047</td>
    </tr>
    <tr>
      <th class="row_heading level0 row60">UvAerosolLayerHeight_sensor_azimuth_angle</th>
      <td class="data row60 col0">439.000000</td>
      <td class="data row60 col1">45.267888</td>
      <td class="data row60 col2">64.614132</td>
      <td class="data row60 col3">-105.004929</td>
      <td class="data row60 col4">72.259964</td>
      <td class="data row60 col5">74.312820</td>
      <td class="data row60 col6">75.785839</td>
      <td class="data row60 col7">80.415855</td>
    </tr>
    <tr>
      <th class="row_heading level0 row61">UvAerosolLayerHeight_solar_azimuth_angle</th>
      <td class="data row61 col0">439.000000</td>
      <td class="data row61 col1">-70.819717</td>
      <td class="data row61 col2">42.181747</td>
      <td class="data row61 col3">-151.315323</td>
      <td class="data row61 col4">-121.968826</td>
      <td class="data row61 col5">-47.388756</td>
      <td class="data row61 col6">-35.689453</td>
      <td class="data row61 col7">-20.665520</td>
    </tr>
    <tr>
      <th class="row_heading level0 row62">UvAerosolLayerHeight_solar_zenith_angle</th>
      <td class="data row62 col0">439.000000</td>
      <td class="data row62 col1">27.172657</td>
      <td class="data row62 col2">3.792400</td>
      <td class="data row62 col3">14.832418</td>
      <td class="data row62 col4">25.517545</td>
      <td class="data row62 col5">27.043358</td>
      <td class="data row62 col6">29.787394</td>
      <td class="data row62 col7">40.452660</td>
    </tr>
    <tr>
      <th class="row_heading level0 row63">Cloud_cloud_fraction</th>
      <td class="data row63 col0">78539.000000</td>
      <td class="data row63 col1">0.597468</td>
      <td class="data row63 col2">0.196503</td>
      <td class="data row63 col3">0.001813</td>
      <td class="data row63 col4">0.462113</td>
      <td class="data row63 col5">0.611152</td>
      <td class="data row63 col6">0.744233</td>
      <td class="data row63 col7">1.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row64">Cloud_cloud_top_pressure</th>
      <td class="data row64 col0">78539.000000</td>
      <td class="data row64 col1">53086.835772</td>
      <td class="data row64 col2">8776.569588</td>
      <td class="data row64 col3">21320.212919</td>
      <td class="data row64 col4">47071.512358</td>
      <td class="data row64 col5">52763.322598</td>
      <td class="data row64 col6">58824.349024</td>
      <td class="data row64 col7">89289.925148</td>
    </tr>
    <tr>
      <th class="row_heading level0 row65">Cloud_cloud_top_height</th>
      <td class="data row65 col0">78539.000000</td>
      <td class="data row65 col1">5592.377478</td>
      <td class="data row65 col2">1428.503002</td>
      <td class="data row65 col3">1050.661782</td>
      <td class="data row65 col4">4595.400519</td>
      <td class="data row65 col5">5573.854309</td>
      <td class="data row65 col6">6542.303642</td>
      <td class="data row65 col7">12384.239458</td>
    </tr>
    <tr>
      <th class="row_heading level0 row66">Cloud_cloud_base_pressure</th>
      <td class="data row66 col0">78539.000000</td>
      <td class="data row66 col1">59420.297456</td>
      <td class="data row66 col2">9051.163609</td>
      <td class="data row66 col3">24779.033704</td>
      <td class="data row66 col4">53175.779928</td>
      <td class="data row66 col5">59332.532548</td>
      <td class="data row66 col6">65663.842684</td>
      <td class="data row66 col7">89291.615576</td>
    </tr>
    <tr>
      <th class="row_heading level0 row67">Cloud_cloud_base_height</th>
      <td class="data row67 col0">78539.000000</td>
      <td class="data row67 col1">4670.430869</td>
      <td class="data row67 col2">1359.251583</td>
      <td class="data row67 col3">1050.496816</td>
      <td class="data row67 col4">3680.856344</td>
      <td class="data row67 col5">4621.755170</td>
      <td class="data row67 col6">5572.983223</td>
      <td class="data row67 col7">11384.239458</td>
    </tr>
    <tr>
      <th class="row_heading level0 row68">Cloud_cloud_optical_depth</th>
      <td class="data row68 col0">78539.000000</td>
      <td class="data row68 col1">19.139241</td>
      <td class="data row68 col2">13.547047</td>
      <td class="data row68 col3">1.844529</td>
      <td class="data row68 col4">9.974574</td>
      <td class="data row68 col5">15.130688</td>
      <td class="data row68 col6">23.785030</td>
      <td class="data row68 col7">250.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row69">Cloud_surface_albedo</th>
      <td class="data row69 col0">78539.000000</td>
      <td class="data row69 col1">0.271460</td>
      <td class="data row69 col2">0.049434</td>
      <td class="data row69 col3">0.017697</td>
      <td class="data row69 col4">0.241453</td>
      <td class="data row69 col5">0.272747</td>
      <td class="data row69 col6">0.302892</td>
      <td class="data row69 col7">0.736514</td>
    </tr>
    <tr>
      <th class="row_heading level0 row70">Cloud_sensor_azimuth_angle</th>
      <td class="data row70 col0">78539.000000</td>
      <td class="data row70 col1">-10.784832</td>
      <td class="data row70 col2">30.374462</td>
      <td class="data row70 col3">-102.739731</td>
      <td class="data row70 col4">-30.309170</td>
      <td class="data row70 col5">-12.673914</td>
      <td class="data row70 col6">9.402202</td>
      <td class="data row70 col7">78.223037</td>
    </tr>
    <tr>
      <th class="row_heading level0 row71">Cloud_sensor_zenith_angle</th>
      <td class="data row71 col0">78539.000000</td>
      <td class="data row71 col1">40.436976</td>
      <td class="data row71 col2">6.428216</td>
      <td class="data row71 col3">2.998873</td>
      <td class="data row71 col4">35.829907</td>
      <td class="data row71 col5">41.119630</td>
      <td class="data row71 col6">44.446272</td>
      <td class="data row71 col7">65.951248</td>
    </tr>
    <tr>
      <th class="row_heading level0 row72">Cloud_solar_azimuth_angle</th>
      <td class="data row72 col0">78539.000000</td>
      <td class="data row72 col1">-86.800583</td>
      <td class="data row72 col2">37.837269</td>
      <td class="data row72 col3">-153.464211</td>
      <td class="data row72 col4">-125.991158</td>
      <td class="data row72 col5">-84.644352</td>
      <td class="data row72 col6">-48.132701</td>
      <td class="data row72 col7">-22.653170</td>
    </tr>
    <tr>
      <th class="row_heading level0 row73">Cloud_solar_zenith_angle</th>
      <td class="data row73 col0">78539.000000</td>
      <td class="data row73 col1">27.925981</td>
      <td class="data row73 col2">4.403835</td>
      <td class="data row73 col3">10.818288</td>
      <td class="data row73 col4">24.686763</td>
      <td class="data row73 col5">28.333630</td>
      <td class="data row73 col6">31.499883</td>
      <td class="data row73 col7">42.060436</td>
    </tr>
    <tr>
      <th class="row_heading level0 row74">emission</th>
      <td class="data row74 col0">79023.000000</td>
      <td class="data row74 col1">81.940552</td>
      <td class="data row74 col2">144.299648</td>
      <td class="data row74 col3">0.000000</td>
      <td class="data row74 col4">9.797995</td>
      <td class="data row74 col5">45.593445</td>
      <td class="data row74 col6">109.549595</td>
      <td class="data row74 col7">3167.768000</td>
    </tr>
  </tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dtypes&#39;</span><span class="p">])</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;missing#&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mi">100</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;missing%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;uniques&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="c1">#sum[&#39;skew&#39;] = df.skew().values</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
    <span class="nb">sum</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">sum</span>

<span class="n">summary</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

<table>
  <thead>
    <tr>
      <th class="blank level0">&#160;</th>
      <th class="col_heading level0 col0">dtypes</th>
      <th class="col_heading level0 col1">missing#</th>
      <th class="col_heading level0 col2">missing%</th>
      <th class="col_heading level0 col3">uniques</th>
      <th class="col_heading level0 col4">count</th>
      <th class="col_heading level0 col5">min</th>
      <th class="col_heading level0 col6">max</th>
      <th class="col_heading level0 col7">mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th class="row_heading level0 row0">latitude</th>
      <td class="data row0 col0">float64</td>
      <td class="data row0 col1">0</td>
      <td class="data row0 col2">0.000000</td>
      <td class="data row0 col3">452</td>
      <td class="data row0 col4">79023</td>
      <td class="data row0 col5">-3.299000</td>
      <td class="data row0 col6">-0.510000</td>
      <td class="data row0 col7">-1.891072</td>
    </tr>
    <tr>
      <th class="row_heading level0 row1">longitude</th>
      <td class="data row1 col0">float64</td>
      <td class="data row1 col1">0</td>
      <td class="data row1 col2">0.000000</td>
      <td class="data row1 col3">453</td>
      <td class="data row1 col4">79023</td>
      <td class="data row1 col5">28.228000</td>
      <td class="data row1 col6">31.532000</td>
      <td class="data row1 col7">29.880155</td>
    </tr>
    <tr>
      <th class="row_heading level0 row2">year</th>
      <td class="data row2 col0">int64</td>
      <td class="data row2 col1">0</td>
      <td class="data row2 col2">0.000000</td>
      <td class="data row2 col3">3</td>
      <td class="data row2 col4">79023</td>
      <td class="data row2 col5">2019.000000</td>
      <td class="data row2 col6">2021.000000</td>
      <td class="data row2 col7">2020.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row3">week_no</th>
      <td class="data row3 col0">int64</td>
      <td class="data row3 col1">0</td>
      <td class="data row3 col2">0.000000</td>
      <td class="data row3 col3">53</td>
      <td class="data row3 col4">79023</td>
      <td class="data row3 col5">0.000000</td>
      <td class="data row3 col6">52.000000</td>
      <td class="data row3 col7">26.000000</td>
    </tr>
    <tr>
      <th class="row_heading level0 row4">SulphurDioxide_SO2_column_number_density</th>
      <td class="data row4 col0">float64</td>
      <td class="data row4 col1">1460900</td>
      <td class="data row4 col2">18.487023</td>
      <td class="data row4 col3">64409</td>
      <td class="data row4 col4">64414</td>
      <td class="data row4 col5">-0.000996</td>
      <td class="data row4 col6">0.004191</td>
      <td class="data row4 col7">0.000048</td>
    </tr>
    <tr>
      <th class="row_heading level0 row5">SulphurDioxide_SO2_column_number_density_amf</th>
      <td class="data row5 col0">float64</td>
      <td class="data row5 col1">1460900</td>
      <td class="data row5 col2">18.487023</td>
      <td class="data row5 col3">64411</td>
      <td class="data row5 col4">64414</td>
      <td class="data row5 col5">0.241822</td>
      <td class="data row5 col6">1.885239</td>
      <td class="data row5 col7">0.834848</td>
    </tr>
    <tr>
      <th class="row_heading level0 row6">SulphurDioxide_SO2_slant_column_number_density</th>
      <td class="data row6 col0">float64</td>
      <td class="data row6 col1">1460900</td>
      <td class="data row6 col2">18.487023</td>
      <td class="data row6 col3">64409</td>
      <td class="data row6 col4">64414</td>
      <td class="data row6 col5">-0.000887</td>
      <td class="data row6 col6">0.004236</td>
      <td class="data row6 col7">0.000035</td>
    </tr>
    <tr>
      <th class="row_heading level0 row7">SulphurDioxide_cloud_fraction</th>
      <td class="data row7 col0">float64</td>
      <td class="data row7 col1">1460900</td>
      <td class="data row7 col2">18.487023</td>
      <td class="data row7 col3">62367</td>
      <td class="data row7 col4">64414</td>
      <td class="data row7 col5">0.000000</td>
      <td class="data row7 col6">0.299998</td>
      <td class="data row7 col7">0.158418</td>
    </tr>
    <tr>
      <th class="row_heading level0 row8">SulphurDioxide_sensor_azimuth_angle</th>
      <td class="data row8 col0">float64</td>
      <td class="data row8 col1">1460900</td>
      <td class="data row8 col2">18.487023</td>
      <td class="data row8 col3">64295</td>
      <td class="data row8 col4">64414</td>
      <td class="data row8 col5">-179.537059</td>
      <td class="data row8 col6">122.095200</td>
      <td class="data row8 col7">-7.925870</td>
    </tr>
    <tr>
      <th class="row_heading level0 row9">SulphurDioxide_sensor_zenith_angle</th>
      <td class="data row9 col0">float64</td>
      <td class="data row9 col1">1460900</td>
      <td class="data row9 col2">18.487023</td>
      <td class="data row9 col3">64218</td>
      <td class="data row9 col4">64414</td>
      <td class="data row9 col5">0.099237</td>
      <td class="data row9 col6">66.242012</td>
      <td class="data row9 col7">37.436189</td>
    </tr>
    <tr>
      <th class="row_heading level0 row10">SulphurDioxide_solar_azimuth_angle</th>
      <td class="data row10 col0">float64</td>
      <td class="data row10 col1">1460900</td>
      <td class="data row10 col2">18.487023</td>
      <td class="data row10 col3">64377</td>
      <td class="data row10 col4">64414</td>
      <td class="data row10 col5">-157.289337</td>
      <td class="data row10 col6">-19.836636</td>
      <td class="data row10 col7">-83.833174</td>
    </tr>
    <tr>
      <th class="row_heading level0 row11">SulphurDioxide_solar_zenith_angle</th>
      <td class="data row11 col0">float64</td>
      <td class="data row11 col1">1460900</td>
      <td class="data row11 col2">18.487023</td>
      <td class="data row11 col3">64376</td>
      <td class="data row11 col4">64414</td>
      <td class="data row11 col5">8.227846</td>
      <td class="data row11 col6">42.887123</td>
      <td class="data row11 col7">27.722311</td>
    </tr>
    <tr>
      <th class="row_heading level0 row12">SulphurDioxide_SO2_column_number_density_15km</th>
      <td class="data row12 col0">float64</td>
      <td class="data row12 col1">1460900</td>
      <td class="data row12 col2">18.487023</td>
      <td class="data row12 col3">64411</td>
      <td class="data row12 col4">64414</td>
      <td class="data row12 col5">-0.001319</td>
      <td class="data row12 col6">0.001956</td>
      <td class="data row12 col7">0.000015</td>
    </tr>
    <tr>
      <th class="row_heading level0 row13">CarbonMonoxide_CO_column_number_density</th>
      <td class="data row13 col0">float64</td>
      <td class="data row13 col1">212200</td>
      <td class="data row13 col2">2.685294</td>
      <td class="data row13 col3">76718</td>
      <td class="data row13 col4">76901</td>
      <td class="data row13 col5">0.015793</td>
      <td class="data row13 col6">0.072990</td>
      <td class="data row13 col7">0.033158</td>
    </tr>
    <tr>
      <th class="row_heading level0 row14">CarbonMonoxide_H2O_column_number_density</th>
      <td class="data row14 col0">float64</td>
      <td class="data row14 col1">212200</td>
      <td class="data row14 col2">2.685294</td>
      <td class="data row14 col3">76724</td>
      <td class="data row14 col4">76901</td>
      <td class="data row14 col5">276.370929</td>
      <td class="data row14 col6">9193.168945</td>
      <td class="data row14 col7">2113.906233</td>
    </tr>
    <tr>
      <th class="row_heading level0 row15">CarbonMonoxide_cloud_height</th>
      <td class="data row15 col0">float64</td>
      <td class="data row15 col1">212200</td>
      <td class="data row15 col2">2.685294</td>
      <td class="data row15 col3">76707</td>
      <td class="data row15 col4">76901</td>
      <td class="data row15 col5">-368.845684</td>
      <td class="data row15 col6">4999.379883</td>
      <td class="data row15 col7">2821.590722</td>
    </tr>
    <tr>
      <th class="row_heading level0 row16">CarbonMonoxide_sensor_altitude</th>
      <td class="data row16 col0">float64</td>
      <td class="data row16 col1">212200</td>
      <td class="data row16 col2">2.685294</td>
      <td class="data row16 col3">72994</td>
      <td class="data row16 col4">76901</td>
      <td class="data row16 col5">829253.687500</td>
      <td class="data row16 col6">830487.875000</td>
      <td class="data row16 col7">829938.633762</td>
    </tr>
    <tr>
      <th class="row_heading level0 row17">CarbonMonoxide_sensor_azimuth_angle</th>
      <td class="data row17 col0">float64</td>
      <td class="data row17 col1">212200</td>
      <td class="data row17 col2">2.685294</td>
      <td class="data row17 col3">76596</td>
      <td class="data row17 col4">76901</td>
      <td class="data row17 col5">-98.300018</td>
      <td class="data row17 col6">76.580513</td>
      <td class="data row17 col7">-7.331051</td>
    </tr>
    <tr>
      <th class="row_heading level0 row18">CarbonMonoxide_sensor_zenith_angle</th>
      <td class="data row18 col0">float64</td>
      <td class="data row18 col1">212200</td>
      <td class="data row18 col2">2.685294</td>
      <td class="data row18 col3">76579</td>
      <td class="data row18 col4">76901</td>
      <td class="data row18 col5">1.107561</td>
      <td class="data row18 col6">65.389618</td>
      <td class="data row18 col7">37.846794</td>
    </tr>
    <tr>
      <th class="row_heading level0 row19">CarbonMonoxide_solar_azimuth_angle</th>
      <td class="data row19 col0">float64</td>
      <td class="data row19 col1">212200</td>
      <td class="data row19 col2">2.685294</td>
      <td class="data row19 col3">76638</td>
      <td class="data row19 col4">76901</td>
      <td class="data row19 col5">-156.620575</td>
      <td class="data row19 col6">-21.999680</td>
      <td class="data row19 col7">-86.049580</td>
    </tr>
    <tr>
      <th class="row_heading level0 row20">CarbonMonoxide_solar_zenith_angle</th>
      <td class="data row20 col0">float64</td>
      <td class="data row20 col1">212200</td>
      <td class="data row20 col2">2.685294</td>
      <td class="data row20 col3">76653</td>
      <td class="data row20 col4">76901</td>
      <td class="data row20 col5">9.028073</td>
      <td class="data row20 col6">42.779541</td>
      <td class="data row20 col7">27.767024</td>
    </tr>
    <tr>
      <th class="row_heading level0 row21">NitrogenDioxide_NO2_column_number_density</th>
      <td class="data row21 col0">float64</td>
      <td class="data row21 col1">1832000</td>
      <td class="data row21 col2">23.183124</td>
      <td class="data row21 col3">60693</td>
      <td class="data row21 col4">60703</td>
      <td class="data row21 col5">-0.000013</td>
      <td class="data row21 col6">0.000217</td>
      <td class="data row21 col7">0.000044</td>
    </tr>
    <tr>
      <th class="row_heading level0 row22">NitrogenDioxide_tropospheric_NO2_column_number_density</th>
      <td class="data row22 col0">float64</td>
      <td class="data row22 col1">1832000</td>
      <td class="data row22 col2">23.183124</td>
      <td class="data row22 col3">60676</td>
      <td class="data row22 col4">60703</td>
      <td class="data row22 col5">-0.000028</td>
      <td class="data row22 col6">0.000173</td>
      <td class="data row22 col7">0.000012</td>
    </tr>
    <tr>
      <th class="row_heading level0 row23">NitrogenDioxide_stratospheric_NO2_column_number_density</th>
      <td class="data row23 col0">float64</td>
      <td class="data row23 col1">1832000</td>
      <td class="data row23 col2">23.183124</td>
      <td class="data row23 col3">60688</td>
      <td class="data row23 col4">60703</td>
      <td class="data row23 col5">0.000022</td>
      <td class="data row23 col6">0.000045</td>
      <td class="data row23 col7">0.000032</td>
    </tr>
    <tr>
      <th class="row_heading level0 row24">NitrogenDioxide_NO2_slant_column_number_density</th>
      <td class="data row24 col0">float64</td>
      <td class="data row24 col1">1832000</td>
      <td class="data row24 col2">23.183124</td>
      <td class="data row24 col3">60686</td>
      <td class="data row24 col4">60703</td>
      <td class="data row24 col5">0.000033</td>
      <td class="data row24 col6">0.000226</td>
      <td class="data row24 col7">0.000097</td>
    </tr>
    <tr>
      <th class="row_heading level0 row25">NitrogenDioxide_tropopause_pressure</th>
      <td class="data row25 col0">float64</td>
      <td class="data row25 col1">1832000</td>
      <td class="data row25 col2">23.183124</td>
      <td class="data row25 col3">56556</td>
      <td class="data row25 col4">60703</td>
      <td class="data row25 col5">7311.868446</td>
      <td class="data row25 col6">13031.054757</td>
      <td class="data row25 col7">8922.568995</td>
    </tr>
    <tr>
      <th class="row_heading level0 row26">NitrogenDioxide_absorbing_aerosol_index</th>
      <td class="data row26 col0">float64</td>
      <td class="data row26 col1">1832000</td>
      <td class="data row26 col2">23.183124</td>
      <td class="data row26 col3">60693</td>
      <td class="data row26 col4">60703</td>
      <td class="data row26 col5">-4.603670</td>
      <td class="data row26 col6">1.372170</td>
      <td class="data row26 col7">-1.812155</td>
    </tr>
    <tr>
      <th class="row_heading level0 row27">NitrogenDioxide_cloud_fraction</th>
      <td class="data row27 col0">float64</td>
      <td class="data row27 col1">1832000</td>
      <td class="data row27 col2">23.183124</td>
      <td class="data row27 col3">59817</td>
      <td class="data row27 col4">60703</td>
      <td class="data row27 col5">0.000000</td>
      <td class="data row27 col6">0.765748</td>
      <td class="data row27 col7">0.097008</td>
    </tr>
    <tr>
      <th class="row_heading level0 row28">NitrogenDioxide_sensor_altitude</th>
      <td class="data row28 col0">float64</td>
      <td class="data row28 col1">1832000</td>
      <td class="data row28 col2">23.183124</td>
      <td class="data row28 col3">55140</td>
      <td class="data row28 col4">60703</td>
      <td class="data row28 col5">829248.037829</td>
      <td class="data row28 col6">830581.562500</td>
      <td class="data row28 col7">829994.224471</td>
    </tr>
    <tr>
      <th class="row_heading level0 row29">NitrogenDioxide_sensor_azimuth_angle</th>
      <td class="data row29 col0">float64</td>
      <td class="data row29 col1">1832000</td>
      <td class="data row29 col2">23.183124</td>
      <td class="data row29 col3">60621</td>
      <td class="data row29 col4">60703</td>
      <td class="data row29 col5">-179.537059</td>
      <td class="data row29 col6">122.095200</td>
      <td class="data row29 col7">-15.937696</td>
    </tr>
    <tr>
      <th class="row_heading level0 row30">NitrogenDioxide_sensor_zenith_angle</th>
      <td class="data row30 col0">float64</td>
      <td class="data row30 col1">1832000</td>
      <td class="data row30 col2">23.183124</td>
      <td class="data row30 col3">60581</td>
      <td class="data row30 col4">60703</td>
      <td class="data row30 col5">0.099237</td>
      <td class="data row30 col6">66.241872</td>
      <td class="data row30 col7">36.852637</td>
    </tr>
    <tr>
      <th class="row_heading level0 row31">NitrogenDioxide_solar_azimuth_angle</th>
      <td class="data row31 col0">float64</td>
      <td class="data row31 col1">1832000</td>
      <td class="data row31 col2">23.183124</td>
      <td class="data row31 col3">60679</td>
      <td class="data row31 col4">60703</td>
      <td class="data row31 col5">-158.883316</td>
      <td class="data row31 col6">-19.863918</td>
      <td class="data row31 col7">-84.260082</td>
    </tr>
    <tr>
      <th class="row_heading level0 row32">NitrogenDioxide_solar_zenith_angle</th>
      <td class="data row32 col0">float64</td>
      <td class="data row32 col1">1832000</td>
      <td class="data row32 col2">23.183124</td>
      <td class="data row32 col3">60681</td>
      <td class="data row32 col4">60703</td>
      <td class="data row32 col5">8.227524</td>
      <td class="data row32 col6">42.981857</td>
      <td class="data row32 col7">28.316388</td>
    </tr>
    <tr>
      <th class="row_heading level0 row33">Formaldehyde_tropospheric_HCHO_column_number_density</th>
      <td class="data row33 col0">float64</td>
      <td class="data row33 col1">727700</td>
      <td class="data row33 col2">9.208711</td>
      <td class="data row33 col3">71733</td>
      <td class="data row33 col4">71746</td>
      <td class="data row33 col5">-0.000445</td>
      <td class="data row33 col6">0.001174</td>
      <td class="data row33 col7">0.000127</td>
    </tr>
    <tr>
      <th class="row_heading level0 row34">Formaldehyde_tropospheric_HCHO_column_number_density_amf</th>
      <td class="data row34 col0">float64</td>
      <td class="data row34 col1">727700</td>
      <td class="data row34 col2">9.208711</td>
      <td class="data row34 col3">71734</td>
      <td class="data row34 col4">71746</td>
      <td class="data row34 col5">0.376463</td>
      <td class="data row34 col6">2.760419</td>
      <td class="data row34 col7">1.254134</td>
    </tr>
    <tr>
      <th class="row_heading level0 row35">Formaldehyde_HCHO_slant_column_number_density</th>
      <td class="data row35 col0">float64</td>
      <td class="data row35 col1">727700</td>
      <td class="data row35 col2">9.208711</td>
      <td class="data row35 col3">71736</td>
      <td class="data row35 col4">71746</td>
      <td class="data row35 col5">-0.000647</td>
      <td class="data row35 col6">0.000856</td>
      <td class="data row35 col7">0.000084</td>
    </tr>
    <tr>
      <th class="row_heading level0 row36">Formaldehyde_cloud_fraction</th>
      <td class="data row36 col0">float64</td>
      <td class="data row36 col1">727700</td>
      <td class="data row36 col2">9.208711</td>
      <td class="data row36 col3">70694</td>
      <td class="data row36 col4">71746</td>
      <td class="data row36 col5">0.000000</td>
      <td class="data row36 col6">0.558128</td>
      <td class="data row36 col7">0.228801</td>
    </tr>
    <tr>
      <th class="row_heading level0 row37">Formaldehyde_solar_zenith_angle</th>
      <td class="data row37 col0">float64</td>
      <td class="data row37 col1">727700</td>
      <td class="data row37 col2">9.208711</td>
      <td class="data row37 col3">71722</td>
      <td class="data row37 col4">71746</td>
      <td class="data row37 col5">8.459617</td>
      <td class="data row37 col6">42.733612</td>
      <td class="data row37 col7">27.887813</td>
    </tr>
    <tr>
      <th class="row_heading level0 row38">Formaldehyde_solar_azimuth_angle</th>
      <td class="data row38 col0">float64</td>
      <td class="data row38 col1">727700</td>
      <td class="data row38 col2">9.208711</td>
      <td class="data row38 col3">71718</td>
      <td class="data row38 col4">71746</td>
      <td class="data row38 col5">-157.362152</td>
      <td class="data row38 col6">-19.718948</td>
      <td class="data row38 col7">-84.605844</td>
    </tr>
    <tr>
      <th class="row_heading level0 row39">Formaldehyde_sensor_zenith_angle</th>
      <td class="data row39 col0">float64</td>
      <td class="data row39 col1">727700</td>
      <td class="data row39 col2">9.208711</td>
      <td class="data row39 col3">71603</td>
      <td class="data row39 col4">71746</td>
      <td class="data row39 col5">0.099237</td>
      <td class="data row39 col6">66.241966</td>
      <td class="data row39 col7">40.478057</td>
    </tr>
    <tr>
      <th class="row_heading level0 row40">Formaldehyde_sensor_azimuth_angle</th>
      <td class="data row40 col0">float64</td>
      <td class="data row40 col1">727700</td>
      <td class="data row40 col2">9.208711</td>
      <td class="data row40 col3">71647</td>
      <td class="data row40 col4">71746</td>
      <td class="data row40 col5">-135.562535</td>
      <td class="data row40 col6">106.133474</td>
      <td class="data row40 col7">-9.396089</td>
    </tr>
    <tr>
      <th class="row_heading level0 row41">UvAerosolIndex_absorbing_aerosol_index</th>
      <td class="data row41 col0">float64</td>
      <td class="data row41 col1">53900</td>
      <td class="data row41 col2">0.682080</td>
      <td class="data row41 col3">78484</td>
      <td class="data row41 col4">78484</td>
      <td class="data row41 col5">-3.248241</td>
      <td class="data row41 col6">1.080224</td>
      <td class="data row41 col7">-1.342787</td>
    </tr>
    <tr>
      <th class="row_heading level0 row42">UvAerosolIndex_sensor_altitude</th>
      <td class="data row42 col0">float64</td>
      <td class="data row42 col1">53900</td>
      <td class="data row42 col2">0.682080</td>
      <td class="data row42 col3">78025</td>
      <td class="data row42 col4">78484</td>
      <td class="data row42 col5">829350.383516</td>
      <td class="data row42 col6">830498.368631</td>
      <td class="data row42 col7">829974.542096</td>
    </tr>
    <tr>
      <th class="row_heading level0 row43">UvAerosolIndex_sensor_azimuth_angle</th>
      <td class="data row43 col0">float64</td>
      <td class="data row43 col1">53900</td>
      <td class="data row43 col2">0.682080</td>
      <td class="data row43 col3">78479</td>
      <td class="data row43 col4">78484</td>
      <td class="data row43 col5">-99.808195</td>
      <td class="data row43 col6">74.349663</td>
      <td class="data row43 col7">-12.739997</td>
    </tr>
    <tr>
      <th class="row_heading level0 row44">UvAerosolIndex_sensor_zenith_angle</th>
      <td class="data row44 col0">float64</td>
      <td class="data row44 col1">53900</td>
      <td class="data row44 col2">0.682080</td>
      <td class="data row44 col3">78479</td>
      <td class="data row44 col4">78484</td>
      <td class="data row44 col5">3.969079</td>
      <td class="data row44 col6">66.450478</td>
      <td class="data row44 col7">39.962875</td>
    </tr>
    <tr>
      <th class="row_heading level0 row45">UvAerosolIndex_solar_azimuth_angle</th>
      <td class="data row45 col0">float64</td>
      <td class="data row45 col1">53900</td>
      <td class="data row45 col2">0.682080</td>
      <td class="data row45 col3">78480</td>
      <td class="data row45 col4">78484</td>
      <td class="data row45 col5">-158.132324</td>
      <td class="data row45 col6">-26.558869</td>
      <td class="data row45 col7">-86.548895</td>
    </tr>
    <tr>
      <th class="row_heading level0 row46">UvAerosolIndex_solar_zenith_angle</th>
      <td class="data row46 col0">float64</td>
      <td class="data row46 col1">53900</td>
      <td class="data row46 col2">0.682080</td>
      <td class="data row46 col3">78481</td>
      <td class="data row46 col4">78484</td>
      <td class="data row46 col5">15.071316</td>
      <td class="data row46 col6">39.473399</td>
      <td class="data row46 col7">28.052553</td>
    </tr>
    <tr>
      <th class="row_heading level0 row47">Ozone_O3_column_number_density</th>
      <td class="data row47 col0">float64</td>
      <td class="data row47 col1">54800</td>
      <td class="data row47 col2">0.693469</td>
      <td class="data row47 col3">78475</td>
      <td class="data row47 col4">78475</td>
      <td class="data row47 col5">0.106192</td>
      <td class="data row47 col6">0.126080</td>
      <td class="data row47 col7">0.117343</td>
    </tr>
    <tr>
      <th class="row_heading level0 row48">Ozone_O3_column_number_density_amf</th>
      <td class="data row48 col0">float64</td>
      <td class="data row48 col1">54800</td>
      <td class="data row48 col2">0.693469</td>
      <td class="data row48 col3">78475</td>
      <td class="data row48 col4">78475</td>
      <td class="data row48 col5">2.111820</td>
      <td class="data row48 col6">3.640139</td>
      <td class="data row48 col7">2.609890</td>
    </tr>
    <tr>
      <th class="row_heading level0 row49">Ozone_O3_slant_column_number_density</th>
      <td class="data row49 col0">float64</td>
      <td class="data row49 col1">54800</td>
      <td class="data row49 col2">0.693469</td>
      <td class="data row49 col3">78475</td>
      <td class="data row49 col4">78475</td>
      <td class="data row49 col5">0.246040</td>
      <td class="data row49 col6">0.418492</td>
      <td class="data row49 col7">0.310802</td>
    </tr>
    <tr>
      <th class="row_heading level0 row50">Ozone_O3_effective_temperature</th>
      <td class="data row50 col0">float64</td>
      <td class="data row50 col1">54800</td>
      <td class="data row50 col2">0.693469</td>
      <td class="data row50 col3">78475</td>
      <td class="data row50 col4">78475</td>
      <td class="data row50 col5">208.137089</td>
      <td class="data row50 col6">237.868655</td>
      <td class="data row50 col7">228.625917</td>
    </tr>
    <tr>
      <th class="row_heading level0 row51">Ozone_cloud_fraction</th>
      <td class="data row51 col0">float64</td>
      <td class="data row51 col1">54800</td>
      <td class="data row51 col2">0.693469</td>
      <td class="data row51 col3">78313</td>
      <td class="data row51 col4">78475</td>
      <td class="data row51 col5">0.002124</td>
      <td class="data row51 col6">1.000000</td>
      <td class="data row51 col7">0.569107</td>
    </tr>
    <tr>
      <th class="row_heading level0 row52">Ozone_sensor_azimuth_angle</th>
      <td class="data row52 col0">float64</td>
      <td class="data row52 col1">54800</td>
      <td class="data row52 col2">0.693469</td>
      <td class="data row52 col3">78469</td>
      <td class="data row52 col4">78475</td>
      <td class="data row52 col5">-99.685563</td>
      <td class="data row52 col6">74.364489</td>
      <td class="data row52 col7">-13.108799</td>
    </tr>
    <tr>
      <th class="row_heading level0 row53">Ozone_sensor_zenith_angle</th>
      <td class="data row53 col0">float64</td>
      <td class="data row53 col1">54800</td>
      <td class="data row53 col2">0.693469</td>
      <td class="data row53 col3">78470</td>
      <td class="data row53 col4">78475</td>
      <td class="data row53 col5">3.372145</td>
      <td class="data row53 col6">66.235573</td>
      <td class="data row53 col7">39.807404</td>
    </tr>
    <tr>
      <th class="row_heading level0 row54">Ozone_solar_azimuth_angle</th>
      <td class="data row54 col0">float64</td>
      <td class="data row54 col1">54800</td>
      <td class="data row54 col2">0.693469</td>
      <td class="data row54 col3">78471</td>
      <td class="data row54 col4">78475</td>
      <td class="data row54 col5">-157.937073</td>
      <td class="data row54 col6">-26.556996</td>
      <td class="data row54 col7">-86.529414</td>
    </tr>
    <tr>
      <th class="row_heading level0 row55">Ozone_solar_zenith_angle</th>
      <td class="data row55 col0">float64</td>
      <td class="data row55 col1">54800</td>
      <td class="data row55 col2">0.693469</td>
      <td class="data row55 col3">78472</td>
      <td class="data row55 col4">78475</td>
      <td class="data row55 col5">15.072850</td>
      <td class="data row55 col6">39.473399</td>
      <td class="data row55 col7">28.104019</td>
    </tr>
    <tr>
      <th class="row_heading level0 row56">UvAerosolLayerHeight_aerosol_height</th>
      <td class="data row56 col0">float64</td>
      <td class="data row56 col1">7858400</td>
      <td class="data row56 col2">99.444466</td>
      <td class="data row56 col3">439</td>
      <td class="data row56 col4">439</td>
      <td class="data row56 col5">1164.338745</td>
      <td class="data row56 col6">12948.073199</td>
      <td class="data row56 col7">3582.971238</td>
    </tr>
    <tr>
      <th class="row_heading level0 row57">UvAerosolLayerHeight_aerosol_pressure</th>
      <td class="data row57 col0">float64</td>
      <td class="data row57 col1">7858400</td>
      <td class="data row57 col2">99.444466</td>
      <td class="data row57 col3">439</td>
      <td class="data row57 col4">439</td>
      <td class="data row57 col5">10920.485315</td>
      <td class="data row57 col6">88296.703125</td>
      <td class="data row57 col7">66718.981285</td>
    </tr>
    <tr>
      <th class="row_heading level0 row58">UvAerosolLayerHeight_aerosol_optical_depth</th>
      <td class="data row58 col0">float64</td>
      <td class="data row58 col1">7858400</td>
      <td class="data row58 col2">99.444466</td>
      <td class="data row58 col3">439</td>
      <td class="data row58 col4">439</td>
      <td class="data row58 col5">-0.377114</td>
      <td class="data row58 col6">2.142224</td>
      <td class="data row58 col7">0.732535</td>
    </tr>
    <tr>
      <th class="row_heading level0 row59">UvAerosolLayerHeight_sensor_zenith_angle</th>
      <td class="data row59 col0">float64</td>
      <td class="data row59 col1">7858400</td>
      <td class="data row59 col2">99.444466</td>
      <td class="data row59 col3">433</td>
      <td class="data row59 col4">439</td>
      <td class="data row59 col5">0.238394</td>
      <td class="data row59 col6">66.165047</td>
      <td class="data row59 col7">30.474482</td>
    </tr>
    <tr>
      <th class="row_heading level0 row60">UvAerosolLayerHeight_sensor_azimuth_angle</th>
      <td class="data row60 col0">float64</td>
      <td class="data row60 col1">7858400</td>
      <td class="data row60 col2">99.444466</td>
      <td class="data row60 col3">433</td>
      <td class="data row60 col4">439</td>
      <td class="data row60 col5">-105.004929</td>
      <td class="data row60 col6">80.415855</td>
      <td class="data row60 col7">45.267888</td>
    </tr>
    <tr>
      <th class="row_heading level0 row61">UvAerosolLayerHeight_solar_azimuth_angle</th>
      <td class="data row61 col0">float64</td>
      <td class="data row61 col1">7858400</td>
      <td class="data row61 col2">99.444466</td>
      <td class="data row61 col3">434</td>
      <td class="data row61 col4">439</td>
      <td class="data row61 col5">-151.315323</td>
      <td class="data row61 col6">-20.665520</td>
      <td class="data row61 col7">-70.819717</td>
    </tr>
    <tr>
      <th class="row_heading level0 row62">UvAerosolLayerHeight_solar_zenith_angle</th>
      <td class="data row62 col0">float64</td>
      <td class="data row62 col1">7858400</td>
      <td class="data row62 col2">99.444466</td>
      <td class="data row62 col3">436</td>
      <td class="data row62 col4">439</td>
      <td class="data row62 col5">14.832418</td>
      <td class="data row62 col6">40.452660</td>
      <td class="data row62 col7">27.172657</td>
    </tr>
    <tr>
      <th class="row_heading level0 row63">Cloud_cloud_fraction</th>
      <td class="data row63 col0">float64</td>
      <td class="data row63 col1">48400</td>
      <td class="data row63 col2">0.612480</td>
      <td class="data row63 col3">78336</td>
      <td class="data row63 col4">78539</td>
      <td class="data row63 col5">0.001813</td>
      <td class="data row63 col6">1.000000</td>
      <td class="data row63 col7">0.597468</td>
    </tr>
    <tr>
      <th class="row_heading level0 row64">Cloud_cloud_top_pressure</th>
      <td class="data row64 col0">float64</td>
      <td class="data row64 col1">48400</td>
      <td class="data row64 col2">0.612480</td>
      <td class="data row64 col3">78538</td>
      <td class="data row64 col4">78539</td>
      <td class="data row64 col5">21320.212919</td>
      <td class="data row64 col6">89289.925148</td>
      <td class="data row64 col7">53086.835772</td>
    </tr>
    <tr>
      <th class="row_heading level0 row65">Cloud_cloud_top_height</th>
      <td class="data row65 col0">float64</td>
      <td class="data row65 col1">48400</td>
      <td class="data row65 col2">0.612480</td>
      <td class="data row65 col3">78538</td>
      <td class="data row65 col4">78539</td>
      <td class="data row65 col5">1050.661782</td>
      <td class="data row65 col6">12384.239458</td>
      <td class="data row65 col7">5592.377478</td>
    </tr>
    <tr>
      <th class="row_heading level0 row66">Cloud_cloud_base_pressure</th>
      <td class="data row66 col0">float64</td>
      <td class="data row66 col1">48400</td>
      <td class="data row66 col2">0.612480</td>
      <td class="data row66 col3">78538</td>
      <td class="data row66 col4">78539</td>
      <td class="data row66 col5">24779.033704</td>
      <td class="data row66 col6">89291.615576</td>
      <td class="data row66 col7">59420.297456</td>
    </tr>
    <tr>
      <th class="row_heading level0 row67">Cloud_cloud_base_height</th>
      <td class="data row67 col0">float64</td>
      <td class="data row67 col1">48400</td>
      <td class="data row67 col2">0.612480</td>
      <td class="data row67 col3">78538</td>
      <td class="data row67 col4">78539</td>
      <td class="data row67 col5">1050.496816</td>
      <td class="data row67 col6">11384.239458</td>
      <td class="data row67 col7">4670.430869</td>
    </tr>
    <tr>
      <th class="row_heading level0 row68">Cloud_cloud_optical_depth</th>
      <td class="data row68 col0">float64</td>
      <td class="data row68 col1">48400</td>
      <td class="data row68 col2">0.612480</td>
      <td class="data row68 col3">78538</td>
      <td class="data row68 col4">78539</td>
      <td class="data row68 col5">1.844529</td>
      <td class="data row68 col6">250.000000</td>
      <td class="data row68 col7">19.139241</td>
    </tr>
    <tr>
      <th class="row_heading level0 row69">Cloud_surface_albedo</th>
      <td class="data row69 col0">float64</td>
      <td class="data row69 col1">48400</td>
      <td class="data row69 col2">0.612480</td>
      <td class="data row69 col3">78539</td>
      <td class="data row69 col4">78539</td>
      <td class="data row69 col5">0.017697</td>
      <td class="data row69 col6">0.736514</td>
      <td class="data row69 col7">0.271460</td>
    </tr>
    <tr>
      <th class="row_heading level0 row70">Cloud_sensor_azimuth_angle</th>
      <td class="data row70 col0">float64</td>
      <td class="data row70 col1">48400</td>
      <td class="data row70 col2">0.612480</td>
      <td class="data row70 col3">78538</td>
      <td class="data row70 col4">78539</td>
      <td class="data row70 col5">-102.739731</td>
      <td class="data row70 col6">78.223037</td>
      <td class="data row70 col7">-10.784832</td>
    </tr>
    <tr>
      <th class="row_heading level0 row71">Cloud_sensor_zenith_angle</th>
      <td class="data row71 col0">float64</td>
      <td class="data row71 col1">48400</td>
      <td class="data row71 col2">0.612480</td>
      <td class="data row71 col3">78539</td>
      <td class="data row71 col4">78539</td>
      <td class="data row71 col5">2.998873</td>
      <td class="data row71 col6">65.951248</td>
      <td class="data row71 col7">40.436976</td>
    </tr>
    <tr>
      <th class="row_heading level0 row72">Cloud_solar_azimuth_angle</th>
      <td class="data row72 col0">float64</td>
      <td class="data row72 col1">48400</td>
      <td class="data row72 col2">0.612480</td>
      <td class="data row72 col3">78539</td>
      <td class="data row72 col4">78539</td>
      <td class="data row72 col5">-153.464211</td>
      <td class="data row72 col6">-22.653170</td>
      <td class="data row72 col7">-86.800583</td>
    </tr>
    <tr>
      <th class="row_heading level0 row73">Cloud_solar_zenith_angle</th>
      <td class="data row73 col0">float64</td>
      <td class="data row73 col1">48400</td>
      <td class="data row73 col2">0.612480</td>
      <td class="data row73 col3">78539</td>
      <td class="data row73 col4">78539</td>
      <td class="data row73 col5">10.818288</td>
      <td class="data row73 col6">42.060436</td>
      <td class="data row73 col7">27.925981</td>
    </tr>
    <tr>
      <th class="row_heading level0 row74">emission</th>
      <td class="data row74 col0">float64</td>
      <td class="data row74 col1">0</td>
      <td class="data row74 col2">0.000000</td>
      <td class="data row74 col3">76533</td>
      <td class="data row74 col4">79023</td>
      <td class="data row74 col5">0.000000</td>
      <td class="data row74 col6">3167.768000</td>
      <td class="data row74 col7">81.940552</td>
    </tr>
  </tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Latitude and longitude</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_mapbox</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> 
                        <span class="n">zoom</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,)</span> 
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">mapbox_style</span><span class="o">=</span><span class="s2">&quot;open-street-map&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Map&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea">
        
        
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea">
<div>                            <div class="plotly-graph-div js-plotly-plot" style="height:800px;width:1000px;"><div class="plot-container plotly"><div class="user-select-none svg-container" style="position: relative;width: 1000px;height: 800px;"><div class="gl-container"><canvas class="gl-canvas gl-canvas-context" width="2000" height="1600" style="position: absolute;top: 0px;left: 0px;overflow: visible;width: 1000px;height: 800px;"></canvas><canvas class="gl-canvas gl-canvas-focus" width="2000" height="1600" style="position: absolute;top: 0px;left: 0px;overflow: visible;width: 1000px;height: 800px;"></canvas><canvas class="gl-canvas gl-canvas-pick" width="2000" height="1600" style="position: absolute;top: 0px;left: 0px;overflow: visible;width: 1000px;height: 800px;"></canvas><div class="mapboxgl-map" style="position: absolute;width: 840px;height: 660px;left: 80px;top: 60px;"><div class="mapboxgl-canary" style="visibility: hidden;"></div><div class="mapboxgl-canvas-container mapboxgl-interactive mapboxgl-touch-drag-pan mapboxgl-touch-zoom-rotate"><canvas class="mapboxgl-canvas" width="1680" height="1320" style="width: 840px;height: 660px;left: 0px;top: 0px;"></canvas></div><div class="mapboxgl-control-container"><div class="mapboxgl-ctrl-top-left"></div><div class="mapboxgl-ctrl-top-right"></div><div class="mapboxgl-ctrl-bottom-left"><div class="mapboxgl-ctrl" style="display: none;"><a rel="noopener" class="mapboxgl-ctrl-logo" target="_blank" href="https://www.mapbox.com/"></a></div></div><div class="mapboxgl-ctrl-bottom-right"><div class="mapboxgl-ctrl mapboxgl-ctrl-attrib mapboxgl-compact"><div class="mapboxgl-ctrl-attrib-inner">&#169; <a rel="noopener" target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</div></div></div></div></div></div>Map<div class="modebar-container" style="position: absolute;top: 0px;right: 0px;width: 100%;"><div class="modebar modebar--hover ease-bg"><div class="modebar-group"><a rel="noopener" class="modebar-btn"></a></div><div class="modebar-group"><a rel="noopener" class="modebar-btn active"></a><a rel="noopener" class="modebar-btn"></a><a rel="noopener" class="modebar-btn"></a></div><div class="modebar-group"><a rel="noopener" class="modebar-btn"></a><a rel="noopener" class="modebar-btn"></a><a rel="noopener" class="modebar-btn"></a></div><div class="modebar-group"><a rel="noopener" href="https://plotly.com/" target="_blank" class="modebar-btn plotlyjsicon modebar-btn--logo">                          </a></div></div></div></div></div></div>                    </div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># line plot for emision </span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;week_no&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;emission&#39;</span><span class="p">,</span> <span class="n">errorbar</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Emission Over Week&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;emission&#39;</span><span class="p">,</span> <span class="n">errorbar</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Emission Over Year&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Source</span> <span class="o">=</span> <span class="s1">&#39;Train&#39;</span><span class="p">),</span> 
                <span class="n">test</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Source</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span><span class="p">)],</span> 
               <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="mi">3</span> <span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.2</span><span class="p">),</span> 
                         <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="mf">0.35</span><span class="p">,</span> <span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]});</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">col</span><span class="p">,</span> <span class="s1">&#39;Source&#39;</span><span class="p">]],</span> <span class="n">x</span> <span class="o">=</span> <span class="n">col</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Source&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{col}</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Source</span> <span class="o">==</span> <span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">col</span><span class="p">]],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">col</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span><span class="n">saturation</span> <span class="o">=</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">fliersize</span><span class="o">=</span> <span class="mf">2.25</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#037d97&#39;</span><span class="p">,</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">);</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Source</span> <span class="o">==</span> <span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">col</span><span class="p">]],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">col</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">fliersize</span><span class="o">=</span> <span class="mf">2.25</span><span class="p">,</span>
                <span class="n">saturation</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#E4591E&#39;</span><span class="p">,</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">);</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">);</span>


<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribution analysis- continuous columns</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
             <span class="n">y</span> <span class="o">=</span> <span class="mf">0.89</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.57</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Correlation</span>

<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">num</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">}</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation Matrix&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h1><b> 3. Data preprocecssing </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-3.-Data-preprocecssing-">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># from @DMITRY UAROV: https://www.kaggle.com/code/dmitryuarov/ps3e20-rwanda-emission-advanced-fe-29-7</span>

<span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])))</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]))))</span>

<span class="n">train</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">get_id</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">get_id</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">new_ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">id_</span><span class="p">:</span> <span class="n">new_id</span> <span class="k">for</span> <span class="n">new_id</span><span class="p">,</span> <span class="n">id_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())}</span>
<span class="n">train</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">new_ids</span><span class="p">)</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">new_ids</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_month</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{row[&quot;year&quot;]}</span><span class="s1">-{row[&quot;week_no&quot;]+1}-1&#39;</span><span class="p">,</span> <span class="s2">&quot;%Y-%W-%w&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span>

<span class="n">rwanda_center</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.9607</span><span class="p">,</span> <span class="mf">29.9707</span><span class="p">)</span>
<span class="n">park_biega</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.8866</span><span class="p">,</span> <span class="mf">28.4518</span><span class="p">)</span>
<span class="n">kirumba</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5658</span><span class="p">,</span> <span class="mf">29.1714</span><span class="p">)</span>
<span class="n">massif</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.42</span><span class="p">,</span> <span class="mf">28.592</span><span class="p">)</span>
<span class="n">lake</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.0073</span><span class="p">,</span> <span class="mf">31.6269</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cluster_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cluster_centers</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;cluster_</span><span class="si">{i}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">haversine</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]),</span> <span class="n">cc</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ft&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;emission&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>  
    <span class="c1"># drop features with more than 50% nan.</span>
    <span class="n">missing_ratios</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">missing_ratios</span><span class="p">[</span><span class="n">missing_ratios</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns_to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    
    <span class="n">cols_save</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;week_no&#39;</span><span class="p">,</span> <span class="s1">&#39;Ozone_solar_azimuth_angle&#39;</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols_save</span><span class="p">]</span>
    
    <span class="c1"># add features</span>
    <span class="n">good_col</span> <span class="o">=</span> <span class="s1">&#39;Ozone_solar_azimuth_angle&#39;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">good_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="n">good_col</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{good_col}</span><span class="s1">_lag_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="n">good_col</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rot_15_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">+</span> \
                     <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rot_15_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">+</span> \
                     <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rot_30_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="o">+</span> \
                     <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rot_30_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">])</span> <span class="o">+</span> \
                     <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">coors</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;dist_rwanda&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_park&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_kirumba&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_massif&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_lake&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="n">rwanda_center</span><span class="p">,</span> <span class="n">park_biega</span><span class="p">,</span> <span class="n">kirumba</span><span class="p">,</span> <span class="n">massif</span><span class="p">,</span> <span class="n">lake</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">haversine</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]),</span> <span class="n">coors</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ft&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;week_no&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">get_month</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_covid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2020</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2021</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_lockdown&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2020</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])))</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;week_no_sin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;week_no&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">52</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;week_no_sin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;week_no&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">52</span><span class="p">))</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
    
<span class="n">train</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">clustering</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<span class="n">cluster_centers</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">centroid</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clustering</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cluster_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cluster_centers</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">),:]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">):,:]</span>
<span class="k">del</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">feature_scalar</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># scalar</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;week_no&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_flag&#39;</span><span class="p">,</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="s1">&#39;emission&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">feature_scalar</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">feature_scalar</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h1><b> 4. Feature Engineering </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-4.-Feature-Engineering-">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calculateRMSE</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">features</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span><span class="n">prediction</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{model}</span><span class="s2"> has RMSE = </span><span class="si">{loss}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h2><b> 4.1 Pearson Correlation </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-4.1-Pearson-Correlation-">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">train_fs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">trainCorr</span> <span class="o">=</span> <span class="n">train_fs</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">corr</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">trainCorr</span><span class="p">[</span><span class="s1">&#39;emission&#39;</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">corr</span><span class="p">[</span><span class="n">corr</span><span class="o">&gt;</span><span class="n">threshold</span><span class="p">]</span>
<span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>emission       1.000000
dist_rwanda    0.240012
cluster_8      0.203746
cluster_0      0.188658
cluster_9      0.143372
cluster_3      0.141644
cluster_2      0.135306
cluster_6      0.131621
dist_lake      0.120052
longitude      0.102746
rot_15_x       0.099087
cluster_4      0.094789
cluster_5      0.094656
rot_30_x       0.091660
rot_30_y       0.065323
dist_park      0.057622
cluster_7      0.055347
Name: emission, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p style="font-family: consolas;font-size: 16px;">⚪ I&#39;m trying to find features that correlate with the target variable, but due to some preprocessing and normalization I&#39;ve done, the current features don&#39;t correlate very well with the target variable.</p>
<p style="font-family: consolas;font-size: 12px;">&#128308; 我们想找到与目标变量相关的特征，但是由于我们进行了一些预处理和标准化，目前的特征与目标变量相关性并不高。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># baseline</span>
<span class="n">featurePC</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">calculateRMSE</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">featurePC</span><span class="p">,</span><span class="s1">&#39;Pearson Correlation&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pearson Correlation has RMSE = 23.56518987736608
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">featurePC</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;emission&#39;</span><span class="p">)</span>
<span class="n">calculateRMSE</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">featurePC</span><span class="p">,</span><span class="s1">&#39;Pearson Correlation&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pearson Correlation has RMSE = 40.99900073067677
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h2><b> 4.2 Step Forward Selection </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-4.2-Step-Forward-Selection-">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># from mlxtend.feature_selection import SequentialFeatureSelector as sfs</span>

<span class="c1"># X_train, X_val, y_train, y_val = train_test_split(X,Y,test_size=0.2, random_state=42)</span>
<span class="c1"># clf = LGBMRegressor()</span>
<span class="c1"># sfs_1 = sfs(clf,k_features=10,forward=True,verbose=1, cv=5)</span>
<span class="c1"># sfs_1 = sfs_1.fit(X_train, y_train)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># feat_cols = list(sfs_1.k_feature_idx_)</span>
<span class="c1"># featureSFS = X.columns[feat_cols].tolist()</span>

<span class="n">featureSFS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
 <span class="s1">&#39;week_no&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ozone_solar_azimuth_angle&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dist_rwanda&#39;</span><span class="p">,</span>
 <span class="s1">&#39;dist_lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;is_covid&#39;</span><span class="p">,</span>
 <span class="s1">&#39;cluster_2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;cluster_3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;cluster_4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;cluster_8&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected features:&quot;</span><span class="p">,</span> <span class="n">featureSFS</span><span class="p">)</span>
<span class="n">calculateRMSE</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">featureSFS</span><span class="p">,</span><span class="s1">&#39;Step Forward Selection&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Selected features: [&#39;id&#39;, &#39;week_no&#39;, &#39;Ozone_solar_azimuth_angle&#39;, &#39;dist_rwanda&#39;, &#39;dist_lake&#39;, &#39;is_covid&#39;, &#39;cluster_2&#39;, &#39;cluster_3&#39;, &#39;cluster_4&#39;, &#39;cluster_8&#39;]
Step Forward Selection has RMSE = 24.851792740323038
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h2><b> 4.3 Recursive Feature elimination </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-4.3-Recursive-Feature-elimination-">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># from sklearn.feature_selection import RFE</span>

<span class="c1"># clf = LGBMRegressor()</span>
<span class="c1"># rfe = RFE(clf)</span>
<span class="c1"># X_rfe = rfe.fit_transform(X,Y)</span>
<span class="c1"># clf.fit(X_rfe,Y)</span>
<span class="c1"># cols = list(X.columns)</span>
<span class="c1"># temp = pd.Series(rfe.support_,index = cols)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># featureRFE = temp[temp==True].index.tolist()</span>
<span class="c1"># print(&quot;Selected features: &quot;,featureRFE)</span>

<span class="n">featureRFE</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;week_no&#39;</span><span class="p">,</span> <span class="s1">&#39;rot_15_y&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_rwanda&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_park&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_kirumba&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_lake&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_0&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_1&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_2&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_3&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_5&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_6&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_8&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster_9&#39;</span><span class="p">]</span>
<span class="n">calculateRMSE</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">featureRFE</span><span class="p">,</span><span class="s1">&#39;Recursive Feature Elimination&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Recursive Feature Elimination has RMSE = 25.24958500023619
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a rel="noopener"></a></p>
<h1><b> 5. Modeling </b><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#-5.-Modeling-">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># selected_feats = train.columns</span>
<span class="n">selected_feats</span> <span class="o">=</span> <span class="n">featureSFS</span>
<span class="c1"># selected_feats = featureRFE</span>


<span class="n">X</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">selected_feats</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">selected_feats</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">xgb_cv_scores</span><span class="p">,</span> <span class="n">xgb_preds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">lgbm_cv_scores</span><span class="p">,</span> <span class="n">lgbm_preds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">rf_cv_scores</span><span class="p">,</span> <span class="n">rf_preds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="nb">list</span><span class="p">()</span>
<span class="c1"># ens_cv_scores, ens_preds = list(), list()</span>

<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_ix</span><span class="p">,</span> <span class="n">test_ix</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_ix</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_ix</span><span class="p">]</span>
    <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_ix</span><span class="p">],</span> <span class="n">Y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_ix</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------------&#39;</span><span class="p">)</span>
    
    <span class="c1">## XGBoost</span>
    <span class="n">xgb_md</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">xgb_pred</span> <span class="o">=</span> <span class="n">xgb_md</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>   
    <span class="n">xgb_score_fold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">xgb_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fold&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;==&gt; XGBoost oof RMSE score is ==&gt;&#39;</span><span class="p">,</span> <span class="n">xgb_score_fold</span><span class="p">)</span>
    <span class="n">xgb_cv_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xgb_score_fold</span><span class="p">)</span>
    
    <span class="n">xgb_pred_test</span> <span class="o">=</span> <span class="n">xgb_md</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
    <span class="n">xgb_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xgb_pred_test</span><span class="p">)</span>
    
    <span class="c1">## LGBM</span>
    <span class="n">lgbm_md</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                           <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
                           <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
                           <span class="n">num_leaves</span> <span class="o">=</span> <span class="mi">105</span><span class="p">,</span>
                           <span class="n">reg_alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="c1">#0.3</span>
                           <span class="n">reg_lambda</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                           <span class="n">subsample</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
                           <span class="n">colsample_bytree</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">lgbm_pred</span> <span class="o">=</span> <span class="n">lgbm_md</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
    <span class="n">lgbm_score_fold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">lgbm_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fold&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;==&gt; LGBM oof RMSE score is ==&gt;&#39;</span><span class="p">,</span> <span class="n">lgbm_score_fold</span><span class="p">)</span>
    <span class="n">lgbm_cv_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lgbm_score_fold</span><span class="p">)</span>
    
    <span class="n">lgbm_pred_test</span> <span class="o">=</span> <span class="n">lgbm_md</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
    <span class="n">lgbm_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lgbm_pred_test</span><span class="p">)</span> 
    
    <span class="c1">## RF</span>
    <span class="n">rf_md</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">rf_pred</span> <span class="o">=</span> <span class="n">rf_md</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
    <span class="n">rf_score_fold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">rf_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fold&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;==&gt; RF oof RMSE score is ==&gt;&#39;</span><span class="p">,</span> <span class="n">rf_score_fold</span><span class="p">)</span>
    <span class="n">rf_cv_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rf_score_fold</span><span class="p">)</span>
    
    <span class="n">rf_pred_test</span> <span class="o">=</span> <span class="n">rf_md</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
    <span class="n">rf_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rf_pred_test</span><span class="p">)</span> 
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average RMSE of XGBoost model is:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xgb_cv_scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average RMSE of LGBM model is:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lgbm_cv_scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average RMSE of RF model is:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rf_cv_scores</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>---------------------------------------------------------------
Fold 1 ==&gt; XGBoost oof RMSE score is ==&gt; 18.358339673432216
Fold 1 ==&gt; LGBM oof RMSE score is ==&gt; 15.894040225541305
Fold 1 ==&gt; RF oof RMSE score is ==&gt; 15.955074893392062
---------------------------------------------------------------
Fold 2 ==&gt; XGBoost oof RMSE score is ==&gt; 21.642007661729128
Fold 2 ==&gt; LGBM oof RMSE score is ==&gt; 22.157630837555818
Fold 2 ==&gt; RF oof RMSE score is ==&gt; 24.688257503937752
---------------------------------------------------------------
Fold 3 ==&gt; XGBoost oof RMSE score is ==&gt; 15.29063293421988
Fold 3 ==&gt; LGBM oof RMSE score is ==&gt; 14.189375499953178
Fold 3 ==&gt; RF oof RMSE score is ==&gt; 14.046235491005021
---------------------------------------------------------------
Average RMSE of XGBoost model is: 18.430326756460406
Average RMSE of LGBM model is: 17.413682187683435
Average RMSE of RF model is: 18.229855962778277
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2><center style="font-family: consolas;font-size: 32px;font-weight: bold;">CV Scores</center><a rel="noopener" class="anchor-link" href="https://htmtopdf.herokuapp.com/ipynbviewer/temp/e2d36097cce9caffe9c0a0736706e911/modelling.html?t=1701490495395#CV-Scores">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>Feature</th>
<th>XGB CV Score</th>
<th>LGBM CV Score</th>
</tr>
</thead>
<tbody>
<tr>
<td>6 Features</td>
<td>19.92</td>
<td>19.66</td>
</tr>
<tr>
<td>Feature SFS</td>
<td>14.62</td>
<td>15.72</td>
</tr>
<tr>
<td>Feature RFE</td>
<td>16.90</td>
<td>16.97</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
    </div>
  </div>


 



<div class="grammarly-desktop-integration"></div><script type="module" src="https://s.brightspace.com/lib/bsi/2024.10.209/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
						if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
							document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
								elm.setAttribute('style', 'display: block; height: 0.5rem;');
							});

							window.D2L.MathJax.loadMathJax({
								outputScale: 1.5,
								renderLatex: false,
								enableMML3Support: false
							});
						}
					});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.10.209/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.10.209/unbundled/embeds.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					window.D2L.EmbedRenderer.renderEmbeds(document.body);
				});</script></body></html>